import{r as l,j as C}from"./iframe-BxHoCVtv.js";import"./UniverseProvider-DsJdPv84.js";import{b as L}from"./Bem-DWdSENOI.js";import{d as S,e as k,i as x,b as $}from"./Optional-CilDcsXt.js";import{e as V}from"./Obj-ycCTN9Ns.js";const q=(e,o)=>{let t=null;const s=()=>{S(t)||(clearTimeout(t),t=null)};return{cancel:s,throttle:(...a)=>{s(),t=setTimeout(()=>{t=null,e.apply(null,a)},o)}}},H=l.createContext(null),M=()=>{const e=l.useContext(H);if(e===null)throw new Error("Dropdown compound components must be rendered within the Dropdown component");return e},I=(e,o,t)=>e==="top"?o.top-t.top:t.bottom-o.bottom,D=(e,o,t)=>e==="left"?o.left-t.left:t.right-o.right,O=({anchorRect:e,anchoredContainerRect:o,side:t,align:s,gap:i,boundaryRect:a=document.documentElement.getBoundingClientRect()})=>{if(t==="top"||t==="bottom"){const r=I(t,e,a),f=t==="top"?e.top-o.height-i:e.bottom+i;let n=e.left;return s==="center"&&(n=e.left+e.width/2-o.width/2),s==="end"&&(n=e.right-o.width),{maxHeight:`${r}px`,top:`${f}px`,left:`${n}px`,minWidth:`${e.width}px`}}if(t==="left"||t==="right"){const r=D(t,e,a),f=t==="left"?e.left-o.width-i:e.right+i;let n=e.top;return s==="center"&&(n=e.top-o.width/2+e.width/2),s==="end"&&(n=e.bottom-o.height),{maxWidth:`${r}px`,top:`${n}px`,left:`${f}px`,minWidth:`${e.width}px`}}return{}},W=(e,o)=>{var t;return((t=e.current)==null?void 0:t.contains(o))??!1},P=l.forwardRef(({children:e,onClose:o,...t},s)=>{const{triggerRef:i,side:a,align:r,gap:f,contentRef:n,triggerEvents:p,debouncedHideHoverablePopover:d,isOpen:c,setIsOpen:m}=M(),[w,_]=l.useState({opacity:"0"}),E=l.useCallback(u=>{m(u.newState==="open")},[m]),y=l.useCallback(()=>{if(x(i.current)&&x(n.current)){const u=document.documentElement.getBoundingClientRect(),g=i.current.getBoundingClientRect(),h=n.current.getBoundingClientRect(),v={opacity:"1",...O({anchorRect:g,anchoredContainerRect:h,side:a,align:r,gap:f,boundaryRect:u})};_(b=>V(v,b)?b:v)}},[n,i,r,a,f]);return l.useEffect(()=>{const u=n.current;if($(u))return;const g=h=>{var v;E(h),h.newState==="closed"&&((v=i.current)==null||v.focus(),o==null||o())};return u.addEventListener("toggle",g),()=>{u.removeEventListener("toggle",g)}},[n,i,E,o]),l.useEffect(()=>{c?y():_({opacity:"0"})},[c,y,e]),l.useEffect(()=>{const u=()=>{var g;(g=n.current)==null||g.hidePopover()};return window.addEventListener("scroll",u,!0),window.addEventListener("resize",u),()=>{window.removeEventListener("scroll",u,!0),window.removeEventListener("resize",u)}},[y,i,n]),C.jsx("div",{popover:"auto",className:L("tox-dropdown-content"),ref:u=>{n.current=u,k(s)?s(u):x(s)&&(s.current=u)},style:{...w},...p.includes("hover")&&{onMouseLeave:d.throttle,onMouseEnter:()=>d.cancel()},...t,children:c&&e})}),N=({children:e})=>{const{triggerRef:o,contentRef:t,triggerEvents:s,debouncedHideHoverablePopover:i,isOpen:a}=M();let r=l.Children.toArray(e)[0];if(!l.isValidElement(r))return null;r=r;const f={onMouseEnter:p=>{var d,c,m;(c=(d=r.props).onMouseEnter)==null||c.call(d,p),i.cancel(),(m=t.current)==null||m.showPopover()},onMouseLeave:p=>{var d,c;(c=(d=r.props).onMouseLeave)==null||c.call(d,p),i.throttle(p)}},n={onClick:p=>{var d,c,m,w;(c=(d=r.props).onClick)==null||c.call(d,p),a?(m=t.current)==null||m.hidePopover():(w=t.current)==null||w.showPopover()}};return l.cloneElement(r,{ref:p=>{o.current=p,k(r.props.ref)?r.props.ref(p):x(r.props.ref)&&(r.props.ref.current=p)},...s.includes("click")&&n,...s.includes("hover")&&f})},T=({children:e,side:o="top",align:t="start",gap:s=8,triggerEvents:i=["click"]})=>{const a=l.useRef(),r=l.useRef(),[f,n]=l.useState(!1),p=l.useMemo(()=>q(c=>{var m;(!(c.relatedTarget instanceof Node)||!W(r,c.relatedTarget))&&((m=r.current)==null||m.hidePopover())},300),[]),d=l.useMemo(()=>({triggerRef:a,contentRef:r,side:o,align:t,gap:s,triggerEvents:i,debouncedHideHoverablePopover:p,isOpen:f,setIsOpen:n}),[a,r,o,t,s,i,p,f]);return C.jsx(H.Provider,{value:d,children:e})};try{T.displayName="Root",T.__docgenInfo={description:"",displayName:"Root",props:{side:{defaultValue:{value:"top"},description:"",name:"side",required:!1,type:{name:'"top" | "bottom" | "left" | "right"'}},align:{defaultValue:{value:"start"},description:"",name:"align",required:!1,type:{name:'"start" | "center" | "end"'}},gap:{defaultValue:{value:"8"},description:"",name:"gap",required:!1,type:{name:"number"}},triggerEvents:{defaultValue:{value:"[ 'click' ]"},description:"",name:"triggerEvents",required:!1,type:{name:'("click" | "hover")[]'}}}}}catch{}try{P.displayName="Content",P.__docgenInfo={description:"",displayName:"Content",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}try{N.displayName="Trigger",N.__docgenInfo={description:"",displayName:"Trigger",props:{}}}catch{}export{P as C,T as R,N as T};
