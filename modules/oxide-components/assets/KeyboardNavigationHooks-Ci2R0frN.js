import{t as ye,O as l,m as pe,b as we,d as K,g as Ee,h as ve,j as ge,k as Se,l as Te,o as De,p as j,f as X,q as ke,r as be,s as k,c as S,u as P,v as Ne,w as Me,n as L}from"./Strings-CEtYgS0A.js";import{r as H}from"./iframe-CocyYyvl.js";const xe=(e,t,o,s)=>{const n=e+t;return n>s?o:n<o?s:n},Ke=(e,t,o)=>Math.min(Math.max(e,t),o),zt=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295,Re=(e,t,o=ye)=>e.exists(s=>o(s,t)),J=(e,t)=>e?l.some(t):l.none(),Ae=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const n="HTML does not have a single root node";throw console.error(n,e),new Error(n)}return b(s.childNodes[0])},Fe=(e,t)=>{const s=(t||document).createElement(e);return b(s)},Pe=(e,t)=>{const s=(t||document).createTextNode(e);return b(s)},b=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},Ie=(e,t,o)=>l.from(e.dom.elementFromPoint(t,o)).map(b),E={fromHtml:Ae,fromTag:Fe,fromText:Pe,fromDom:b,fromPoint:Ie},Le=9,Q=11,Y=1,He=3,Z=(e,t)=>{const o=e.dom;if(o.nodeType!==Y)return!1;{const s=o;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},C=e=>e.nodeType!==Y&&e.nodeType!==Le&&e.nodeType!==Q||e.childElementCount===0,_e=(e,t)=>{const o=t===void 0?document:t.dom;return C(o)?[]:pe(o.querySelectorAll(e),E.fromDom)},Ve=(e,t)=>{const o=t===void 0?document:t.dom;return C(o)?l.none():l.from(o.querySelector(e)).map(E.fromDom)},_=(e,t)=>e.dom===t.dom,$e=e=>e.dom.nodeName.toLowerCase(),Oe=e=>e.dom.nodeType,ee=e=>t=>Oe(t)===e,Ue=ee(He),ze=ee(Q),Be=e=>l.from(e.dom.parentNode).map(E.fromDom),qe=e=>Be(e),We=(e,t)=>{const o=e.dom.childNodes;return l.from(o[t]).map(E.fromDom)},Ge=e=>We(e,0),je=e=>ze(e)&&we(e.dom.host),te=e=>E.fromDom(e.dom.getRootNode()),Xe=e=>{const t=te(e);return je(t)?l.some(t):l.none()},Je=e=>E.fromDom(e.dom.host),Qe=()=>E.fromDom(document),Bt=(e,t=!1)=>e.dom.focus({preventScroll:t}),Ye=(e=Qe())=>l.from(e.dom.activeElement).map(E.fromDom),Ze=e=>Ye(te(e)).filter(t=>e.dom.contains(t.dom)),oe=(e,t)=>{const o=e.dom.getAttribute(t);return o===null?void 0:o},Ce=(e,t)=>l.from(oe(e,t)),et=(e,t)=>{e.dom.removeAttribute(t)},R=e=>e.style!==void 0&&K(e.style.getPropertyValue),V=e=>{const t=Ue(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const o=t.ownerDocument;return Xe(E.fromDom(t)).fold(()=>o.body.contains(t),Ee(V,Je))},tt=(e,t,o)=>{if(!ge(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);R(e)&&e.style.setProperty(t,o)},ot=(e,t)=>{R(e)&&e.style.removeProperty(t)},qt=(e,t,o)=>{const s=e.dom;tt(s,t,o)},I=(e,t)=>{const o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return n===""&&!V(e)?st(o,t):n},st=(e,t)=>R(e)?e.style.getPropertyValue(t):"",Wt=(e,t)=>{const o=e.dom;ot(o,t),Re(Ce(e,"style").map(ve),"")&&et(e,"style")},nt=(e,t)=>{const o=(c,d)=>{if(!Te(d)&&!d.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+d);const r=c.dom;R(r)&&(r.style[e]=d+"px")},s=c=>{const d=t(c);if(d<=0||d===null){const r=I(c,e);return parseFloat(r)||0}return d},n=s,a=(c,d)=>Se(d,(r,u)=>{const p=I(c,u),g=p===void 0?0:parseInt(p,10);return isNaN(g)?r:r+g},0);return{set:o,get:s,getOuter:n,aggregate:a,max:(c,d,r)=>{const u=a(c,r);return d>u?d-u:0}}},rt=nt("height",e=>{const t=e.dom;return V(e)?t.getBoundingClientRect().height:t.offsetHeight}),ct=e=>rt.get(e),at=e=>e.offsetWidth<=0&&e.offsetHeight<=0,ut=e=>!at(e.dom),se=(e,t)=>o=>dt(o)==="rtl"?t:e,dt=e=>I(e,"direction")==="rtl"?"rtl":"ltr",lt=(e,t,o,s,n)=>e(o,s)?l.some(o):K(n)&&n(o)?l.none():t(o,s,n),it=(e,t,o)=>{let s=e.dom;const n=K(o)?o:De;for(;s.parentNode;){s=s.parentNode;const a=E.fromDom(s);if(t(a))return l.some(a);if(n(a))break}return l.none()},mt=(e,t,o)=>it(e,s=>Z(s,t),o),ft=(e,t)=>Ve(t,e),ne=(e,t,o)=>lt((n,a)=>Z(n,a),mt,e,t,o),$=(e,t)=>_e(t,e),re=e=>(t,o,s)=>{const n=e(t);return pt(n,t,o,s)},ht=(e,t)=>{const o=se(e,t);return re(o)},yt=(e,t)=>{const o=se(t,e);return re(o)},pt=(e,t,o,s)=>s.focusManager.get(t).bind(a=>e(t,a,s)).map(a=>(s.focusManager.set(t,a),!0)),wt=(e,t)=>j(e,t).map(o=>({index:o,candidates:e})),Et=(e,t,o)=>{const s=y=>_(y,t),n=$(e,o),a=X(n,ut);return wt(a,s)},ce=(e,t,o,s,n)=>{const a=c=>$e(c)==="button"&&oe(c,"disabled")==="disabled",y=(c,d,r)=>n(c,d,s,0,r.length-1,r[d],u=>a(r[u])?y(c,u,r):l.from(r[u]));return Et(e,o,t).bind(c=>{const d=c.index,r=c.candidates;return y(d,d,r)})},vt=(e,t,o,s)=>ce(e,t,o,s,(n,a,y,c,d,r,u)=>{const p=Ke(a+y,c,d);return p===n?l.from(r):u(p)}),gt=(e,t,o,s)=>ce(e,t,o,s,(n,a,y,c,d,r,u)=>{const p=xe(a,y,c,d);return p===n?l.none():u(p)}),St=()=>({get:o=>Ze(o),set:(o,s)=>{s.dom.focus()}});var ae=(e=>(e.OnFocusMode="onFocus",e))(ae||{});const m=e=>t=>be(e,o=>o.code===t.code||o.key===t.key||o.which===t.which),T=e=>t=>ke(e,o=>o(t)),M=e=>e.shiftKey===!0,W=e=>!M(e),f=(e,t)=>({matches:e,classification:t}),Tt=(e,t)=>k(e,s=>s.matches(t)).map(s=>s.classification),O=(e,t,o,s)=>{const n={...e,focusManager:St(),focusInside:ae.OnFocusMode,focusIn:s},a=(r,u,p)=>{const g=p(r,u,n);return Tt(g,u).bind(N=>N(r,u,n))};return{handleKeydown:(r,u)=>a(r,u,t).each(p=>{u.preventDefault(),u.stopPropagation()}),handleKeyup:(r,u)=>a(r,u,o).each(()=>{u.preventDefault(),u.stopPropagation()}),handleFocus:(r,u)=>{s(n).each(p=>{p(r,n),u.preventDefault(),u.stopPropagation()})}}},D=[{code:"Tab",key:"Tab",which:9}],x=[{code:"Enter",key:"Enter",which:13}],ue=[{code:"ArrowLeft",key:"ArrowLeft",which:37}],de=[{code:"ArrowUp",key:"ArrowUp",which:38}],le=[{code:"ArrowRight",key:"ArrowRight",which:39}],ie=[{code:"ArrowDown",key:"ArrowDown",which:40}],U=[{code:"Space",key:" ",which:32}],z=[{code:"Escape",key:"Escape",which:27}],Dt=(e,t)=>{const o=i=>(i.dom.click(),l.some(!0)),s=(i,w)=>w.closest?w.focusManager.get(i).bind(h=>ne(h,w.selector)):w.focusManager.get(i),n=(i,w,h)=>s(i,h).bind(v=>h.execute(v)),a=(i,w,h)=>s(i,h).bind(v=>h.escape(v)),y=(i,w)=>{ft(i,w.selector).each(h=>{w.focusManager.set(i,h)})},c=i=>(w,h,v)=>(v.cycles?gt:vt)(w,v.selector,h,i),d=c(-1),r=c(1),u=i=>(w,h,v)=>i(w,h,v),p=(i,w,h)=>{const v=[...h.allowHorizontal?ue:[]].concat(h.allowVertical?de:[]),q=[...h.allowHorizontal?le:[]].concat(h.allowVertical?ie:[]);return[f(m(v),u(ht(d,r))),f(m(q),u(yt(d,r))),f(m(x),n),f(m(U),n),f(m(z),a)]},g=S([]),N={execute:o,escape:S(l.none()),allowVertical:!0,allowHorizontal:!0,cycles:!0,focusIn:!1,closest:!0,...t},F=O(N,p,g,()=>J(N.focusIn,y));return{keydown:i=>F.handleKeydown(e,i),keyup:i=>F.handleKeyup(e,i),focus:i=>F.handleFocus(e,i)}},kt=(e,t)=>{const o=(c,d,r)=>[f(T([M,m(x)]),r.onShiftEnter),f(T([W,m(x)]),r.onEnter),f(T([M,m(D)]),r.onShiftTab),f(T([W,m(D)]),r.onTab),f(m(de),r.onUp),f(m(ie),r.onDown),f(m(ue),r.onLeft),f(m(le),r.onRight),f(m(U),r.onSpace)],s=(c,d,r)=>[f(m(z),r.onEscape)],n=c=>()=>K(c)?(c(),l.some(!0)):l.none(),a={onSpace:n(t.onSpace),onEnter:n(t.onEnter),onShiftEnter:n(t.onShiftEnter),onTab:n(t.onTab),onShiftTab:n(t.onShiftTab),onLeft:n(t.onLeft),onRight:n(t.onRight),onUp:n(t.onUp),onDown:n(t.onDown),onEscape:n(t.onEscape)},y=O(a,o,s,()=>l.none());return{keydown:c=>y.handleKeydown(e,c),keyup:c=>y.handleKeyup(e,c),focus:c=>y.handleFocus(e,c)}},bt=(e,t,o)=>{const s=P(e.slice(0,t)),n=P(e.slice(t+1));return k(s.concat(n),o)},Nt=(e,t,o)=>{const s=P(e.slice(0,t));return k(s,o)},Mt=(e,t,o)=>{const s=e.slice(0,t),n=e.slice(t+1);return k(n.concat(s),o)},xt=(e,t,o)=>{const s=e.slice(t+1);return k(s,o)},Kt=e=>ct(e)>0,Rt=(e,t)=>{const o=$(e,t.selector),s=X(o,n=>Kt(n));return l.from(s[t.firstTabstop])},A=(e,t)=>t.closest?t.focusManager.get(e).bind(o=>ne(o,t.selector)):t.focusManager.get(e),At=(e,t)=>e.useTabstopAt(t),Ft=e=>qe(e).bind(Ge).exists(t=>_(t,e)),Pt=(e,t)=>{Rt(e,t).each(o=>t.focusManager.set(e,o))},It=(e,t,o,s,n)=>n(t,o,a=>At(s,a)).fold(()=>s.cyclic?l.some(!0):l.none(),a=>(s.focusManager.set(e,a),l.some(!0))),me=(e,t,o,s)=>{const n=$(e,o.selector);return A(e,o).bind(a=>j(n,Me(_,a)).bind(c=>It(e,n,c,o,s)))},fe=(e,t,o)=>{const s=o.cyclic?bt:Nt;return me(e,t,o,s)},he=(e,t,o)=>{const s=o.cyclic?Mt:xt;return me(e,t,o,s)},Lt=(e,t,o)=>A(e,o).filter(s=>!o.useTabstopAt(s)).bind(s=>(Ft(s)?fe:he)(e,t,o)),G=(e,t,o)=>A(e,o).bind(s=>o.execute(s)),Ht=(e,t,o)=>A(e,o).bind(s=>o.escape(s)),_t=S([f(T([M,m(D)]),fe),f(m(D),he),f(m(x),G),f(m(U),G),f(m(z),Ht)]),Vt=S([f(m(D),Lt)]),$t=(e,t)=>{const o={execute:S(l.none()),escape:S(l.none()),firstTabstop:0,useTabstopAt:Ne,cyclic:!0,focusIn:!1,closest:!0,...t},s=O(o,_t,Vt,()=>J(o.focusIn,Pt));return{keydown:n=>s.handleKeydown(e,n),keyup:n=>s.handleKeyup(e,n),focus:n=>s.handleFocus(e,n)}},B=(e,t)=>(e==null||e.addEventListener("keydown",t.keydown),e==null||e.addEventListener("keyup",t.keyup),e==null||e.addEventListener("focus",t.focus),()=>{e==null||e.removeEventListener("keydown",t.keydown),e==null||e.removeEventListener("keyup",t.keyup),e==null||e.removeEventListener("focus",t.focus)}),Gt=e=>{H.useEffect(()=>{const{containerRef:t}=e;if(t.current){const o=$t(E.fromDom(t.current),e);return B(t.current,o)}else return L},[])},jt=e=>{H.useEffect(()=>{const{containerRef:t}=e;if(t.current){const o=Dt(E.fromDom(t.current),e);return B(t.current,o)}else return L},[])},Xt=e=>{H.useEffect(()=>{const{containerRef:t}=e;if(t.current){const o=kt(E.fromDom(t.current),e);return B(t.current,o)}else return L},[e])};export{E as S,Gt as a,Wt as b,jt as c,ft as d,$ as e,Bt as f,Be as p,zt as r,qt as s,Xt as u};
