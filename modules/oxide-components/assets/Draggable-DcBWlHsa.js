import{r as i,j as P}from"./iframe-CTdvD1WV.js";import{e as v,O as H}from"./Optional-DSwtTfFR.js";import{c as I}from"./Fun--VEwoXIw.js";const w=t=>t==="top-left",$=t=>t==="top-right",E=t=>t==="bottom-left",L=t=>w(t)||E(t),V=t=>w(t)||$(t),j=(t,e)=>({deltaX:e.x-t.x,deltaY:e.y-t.y}),_=(t,e,o)=>Math.min(o,Math.max(e,t)),q=(t,e,o)=>{const r=t.x+t.width,a=t.y+t.height;return{x:Math.round(L(o)?t.x:e.width-r),y:Math.round(V(o)?t.y:e.height-a)}},B=(t,e,o,r)=>{const{upperLeftCorner:a,bottomRightCorner:n}=o,s=t.x+t.width,d=t.y+t.height;return{x:{min:Math.ceil(a.x+(e.x-t.x))-r.horizontal,max:Math.floor(n.x-(s-e.x))+r.horizontal},y:{min:Math.ceil(a.y+(e.y-t.y))-r.vertical,max:Math.floor(n.y-(d-e.y))+r.vertical}}},O=i.createContext(null),N=()=>{const t=i.useContext(O);if(t===null)throw new Error("Draggable compound components must be rendered within the Draggable component");return t},T=t=>`translate3d(${t.x}px, ${t.y}px, 0px)`,M=t=>({x:v(t.x)?`${t.x}px`:t.x,y:v(t.y)?`${t.y}px`:t.y}),S=(t,e,o,r)=>{const{x:a,y:n}=r.fold(I(t),({width:s,height:d})=>({x:`min(${t.x}, calc(100% - (${s} * ${1-e.horizontal}))`,y:`min(${t.y}, calc(100% - (${d} * ${1-e.vertical}))`}));return w(o)?{top:n,left:a}:$(o)?{top:n,right:a}:E(o)?{bottom:n,left:a}:{bottom:n,right:a}},X=(t,e,o,r,a,n)=>a?{transform:T(t),...S(M(e),r,o,n)}:S(M(e),r,o,n),z=i.forwardRef(({children:t,style:e,origin:o="top-left",initialPosition:r={x:0,y:0},declaredSize:a,...n},s)=>{const[d,h]=i.useState({x:0,y:0}),[g,p]=i.useState(r),[m,b]=i.useState(!1),y=i.useRef(null),x=i.useMemo(()=>{var u,f;return{horizontal:((u=n.allowedOverflow)==null?void 0:u.horizontal)??0,vertical:((f=n.allowedOverflow)==null?void 0:f.vertical)??0}},[n.allowedOverflow]),R=X(d,g,o,x,m,H.from(a)),c=i.useMemo(()=>({setShift:h,draggableRef:y,isDragging:m,setIsDragging:b,setPosition:p,allowedOverflow:x,origin:o}),[m,x,o]),l=i.useCallback(u=>{typeof s=="function"?s(u):s&&(s.current=u),y.current=u},[s]);return P.jsx(O.Provider,{value:c,children:P.jsx("div",{ref:l,style:{...e,...R},...n,children:t})})}),D=({children:t})=>{const e=i.useRef(null),o=i.useRef({x:0,y:0}),r=i.useRef({x:{min:0,max:0},y:{min:0,max:0}}),{setShift:a,draggableRef:n,isDragging:s,setIsDragging:d,setPosition:h,allowedOverflow:g,origin:p}=N(),m=i.useCallback(()=>{if(d(!1),a({x:0,y:0}),n.current!==null){const c=n.current.getBoundingClientRect(),l={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};h(q(c,l,p))}},[d,a,n,h,p]),b=i.useCallback(c=>{if(n.current===null)return;d(!0),e.current=c.target,e.current.setPointerCapture(c.pointerId);const l={x:Math.round(c.clientX),y:Math.round(c.clientY)};o.current=l;const u=n.current.getBoundingClientRect(),f={horizontal:Math.round(u.width*g.horizontal),vertical:Math.round(u.height*g.vertical)},C={upperLeftCorner:{x:0,y:0},bottomRightCorner:{x:document.documentElement.clientWidth,y:document.documentElement.clientHeight}};r.current=B(u,l,C,f)},[n,d,g]),y=i.useCallback(c=>{if(s){const l={x:_(Math.round(c.clientX),r.current.x.min,r.current.x.max),y:_(Math.round(c.clientY),r.current.y.min,r.current.y.max)},{deltaX:u,deltaY:f}=j(o.current,l);o.current=l,a(({x:C,y:k})=>({x:C+u,y:k+f}))}},[s,a]),x=i.useCallback(c=>{var l;(l=e.current)==null||l.releasePointerCapture(c.pointerId),m()},[m]),R=i.useCallback(()=>{s&&m()},[m,s]);return P.jsx("div",{onPointerDown:b,onPointerUp:x,onPointerMove:y,onLostPointerCapture:R,style:{cursor:s?"grabbing":"grab",userSelect:"none"},children:t})};try{z.displayName="Root",z.__docgenInfo={description:"",displayName:"Root",props:{popover:{defaultValue:null,description:"",name:"popover",required:!1,type:{name:'"auto" | "hint" | "manual"'}},origin:{defaultValue:{value:"top-left"},description:"",name:"origin",required:!1,type:{name:"Origin"}},initialPosition:{defaultValue:{value:"{ x: 0, y: 0 }"},description:"",name:"initialPosition",required:!1,type:{name:"CssPosition"}},declaredSize:{defaultValue:null,description:"",name:"declaredSize",required:!1,type:{name:"CssSize"}},allowedOverflow:{defaultValue:null,description:"",name:"allowedOverflow",required:!1,type:{name:"Partial<AllowedOverflow>"}}}}}catch{}try{D.displayName="Handle",D.__docgenInfo={description:"",displayName:"Handle",props:{}}}catch{}export{D as H,z as R};
