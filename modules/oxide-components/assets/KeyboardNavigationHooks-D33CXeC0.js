import{O as d,g as Te,i as Se,c as L,d as De,f as ke}from"./Optional-DbTLtGQT.js";import{r as M}from"./iframe-oWtbcp7y.js";import{t as Y,b as be,a as Ne,c as v,d as Me,e as Ke,n as K}from"./Fun--VEwoXIw.js";import{m as xe,t as Re,a as Fe,b as He,d as Pe,g as x,h as Z,f as ee,j as $}from"./Strings-tLOZuS7x.js";const Le=typeof window<"u"?window:Function("return this;")(),Ae=(e,t,n,o)=>{const s=e+t;return s>o?n:s<n?o:s},Oe=(e,t,n)=>Math.min(Math.max(e,t),n),ln=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295,Ie=(e,t,n=Y)=>e.exists(o=>n(o,t)),mn=(e,t,n=Y)=>_e(e,t,n).getOr(e.isNone()&&t.isNone()),_e=(e,t,n)=>e.isSome()&&t.isSome()?d.some(n(e.getOrDie(),t.getOrDie())):d.none(),te=(e,t)=>e?d.some(t):d.none(),$e=(e,t)=>{let n=t??Le;for(let o=0;o<e.length&&n!==void 0&&n!==null;++o)n=n[e[o]];return n},ne=(e,t)=>{const n=e.split(".");return $e(n,t)},Ve=(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const s="HTML does not have a single root node";throw console.error(s,e),new Error(s)}return R(o.childNodes[0])},Ue=(e,t)=>{const o=(t||document).createElement(e);return R(o)},ze=(e,t)=>{const o=(t||document).createTextNode(e);return R(o)},R=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},Be=(e,t,n)=>d.from(e.dom.elementFromPoint(t,n)).map(R),w={fromHtml:Ve,fromTag:Ue,fromText:ze,fromDom:R,fromPoint:Be},qe=9,oe=11,U=1,je=3,se=(e,t)=>{const n=e.dom;if(n.nodeType!==U)return!1;{const o=n;if(o.matches!==void 0)return o.matches(t);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(t);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(t);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},re=e=>e.nodeType!==U&&e.nodeType!==qe&&e.nodeType!==oe||e.childElementCount===0,Ge=(e,t)=>{const n=t===void 0?document:t.dom;return re(n)?[]:xe(n.querySelectorAll(e),w.fromDom)},We=(e,t)=>{const n=t===void 0?document:t.dom;return re(n)?d.none():d.from(n.querySelector(e)).map(w.fromDom)},z=(e,t)=>e.dom===t.dom,fn=(e,t)=>{const n=e.dom,o=t.dom;return n===o?!1:n.contains(o)},Ce=(e,t)=>ne(e,t),Xe=(e,t)=>{const n=Ce(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},Je=Object.getPrototypeOf,Qe=e=>Xe("HTMLElement",e),Ye=e=>{const t=ne("ownerDocument.defaultView",e);return Te(e)&&(Qe(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(Je(e).constructor.name))},ce=e=>e.dom.nodeName.toLowerCase(),Ze=e=>e.dom.nodeType,B=e=>t=>Ze(t)===e,yn=e=>ae(e)&&Ye(e.dom),ae=B(U),et=B(je),tt=B(oe),ue=e=>t=>ae(t)&&ce(t)===e,nt=e=>d.from(e.dom.parentNode).map(w.fromDom),ot=e=>nt(e),st=(e,t)=>{const n=e.dom.childNodes;return d.from(n[t]).map(w.fromDom)},rt=e=>st(e,0),ct=e=>tt(e)&&Se(e.dom.host),de=e=>w.fromDom(e.dom.getRootNode()),at=e=>{const t=de(e);return ct(t)?d.some(t):d.none()},ut=e=>w.fromDom(e.dom.host),dt=()=>w.fromDom(document),hn=(e,t=!1)=>e.dom.focus({preventScroll:t}),lt=(e=dt())=>d.from(e.dom.activeElement).map(w.fromDom),it=e=>lt(de(e)).filter(t=>e.dom.contains(t.dom)),q=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},mt=(e,t)=>d.from(q(e,t)),ft=(e,t)=>{e.dom.removeAttribute(t)},A=e=>e.style!==void 0&&L(e.style.getPropertyValue),j=e=>{const t=et(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return at(w.fromDom(t)).fold(()=>n.body.contains(t),be(j,ut))},yt=(e,t,n)=>{if(!De(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);A(e)&&e.style.setProperty(t,n)},ht=(e,t)=>{A(e)&&e.style.removeProperty(t)},pn=(e,t,n)=>{const o=e.dom;yt(o,t,n)},V=(e,t)=>{const n=e.dom,s=window.getComputedStyle(n).getPropertyValue(t);return s===""&&!j(e)?pt(n,t):s},pt=(e,t)=>A(e)?e.style.getPropertyValue(t):"",wn=(e,t)=>{const n=e.dom;ht(n,t),Ie(mt(e,"style").map(Re),"")&&ft(e,"style")},wt=(e,t)=>{const n=(r,l)=>{if(!ke(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const c=r.dom;A(c)&&(c.style[e]=l+"px")},o=r=>{const l=t(r);if(l<=0||l===null){const c=V(r,e);return parseFloat(c)||0}return l},s=o,a=(r,l)=>Fe(l,(c,u)=>{const f=V(r,u),T=f===void 0?0:parseInt(f,10);return isNaN(T)?c:c+T},0);return{set:n,get:o,getOuter:s,aggregate:a,max:(r,l,c)=>{const u=a(r,c);return l>u?l-u:0}}},Et=wt("height",e=>{const t=e.dom;return j(e)?t.getBoundingClientRect().height:t.offsetHeight}),gt=e=>Et.get(e),vt=e=>e.offsetWidth<=0&&e.offsetHeight<=0,Tt=e=>!vt(e.dom),le=(e,t)=>n=>St(n)==="rtl"?t:e,St=e=>V(e,"direction")==="rtl"?"rtl":"ltr",Dt=(e,t,n,o,s)=>e(n,o)?d.some(n):L(s)&&s(n)?d.none():t(n,o,s),kt=(e,t,n)=>{let o=e.dom;const s=L(n)?n:Ne;for(;o.parentNode;){o=o.parentNode;const a=w.fromDom(o);if(t(a))return d.some(a);if(s(a))break}return d.none()},bt=(e,t,n)=>kt(e,o=>se(o,t),n),Nt=(e,t)=>We(t,e),ie=(e,t,n)=>Dt((s,a)=>se(s,a),bt,e,t,n),G=(e,t)=>Ge(t,e),Mt=()=>({get:n=>it(n),set:(n,o)=>{o.dom.focus()}});var me=(e=>(e.OnFocusMode="onFocus",e))(me||{});const i=e=>t=>Pe(e,n=>n.code===t.code||n.key===t.key||n.which===t.which),D=e=>t=>He(e,n=>n(t)),P=e=>e.shiftKey===!0,Kt=e=>e.ctrlKey===!0,X=e=>!P(e),m=(e,t)=>({matches:e,classification:t}),xt=(e,t)=>x(e,o=>o.matches(t)).map(o=>o.classification),F=(e,t,n,o)=>{const s={...e,focusManager:Mt(),focusInside:me.OnFocusMode,focusIn:o},a=(c,u,f)=>{const T=f(c,u,s);return xt(T,u).bind(S=>S(c,u,s))};return{handleKeydown:(c,u)=>a(c,u,t).each(f=>{u.preventDefault(),u.stopPropagation()}),handleKeyup:(c,u)=>a(c,u,n).each(()=>{u.preventDefault(),u.stopPropagation()}),handleFocus:(c,u)=>{o(s).each(f=>{f(c,s),u.preventDefault(),u.stopPropagation()})}}},b=[{code:"Tab",key:"Tab",which:9}],k=[{code:"Enter",key:"Enter",which:13}],fe=[{code:"ArrowLeft",key:"ArrowLeft",which:37}],ye=[{code:"ArrowUp",key:"ArrowUp",which:38}],he=[{code:"ArrowRight",key:"ArrowRight",which:39}],W=[{code:"ArrowDown",key:"ArrowDown",which:40}],N=[{code:"Space",key:" ",which:32}],O=[{code:"Escape",key:"Escape",which:27}],Rt=(e,t)=>{const n={...t},o=(r,l,c)=>c.onEscape(r,l),s=v([]),a=v([m(i(O),o)]),y=F(n,s,a,()=>d.none());return{keydown:r=>y.handleKeydown(e,r),keyup:r=>y.handleKeyup(e,r),focus:r=>y.handleFocus(e,r)}},Ft=ue("input"),Ht=e=>q(e,"type")!=="radio",Pt=ue("textarea"),J=e=>Ft(e)&&Ht(e)||Pt(e),Lt=()=>d.some(!0),At=(e,t)=>{const n={...t},o=(f,T,S)=>S.doExecute(f,T),s=t.useSpace&&!J(e)?N:[],a=t.useEnter?k:[],y=t.useDown?W:[],r=s.concat(a).concat(y),l=v([m(i(r),o)].concat(t.useControlEnter?[m(D([Kt,i(k)]),o)]:[])),c=v(t.useSpace&&!J(e)?[m(i(N),Lt)]:[]),u=F(n,l,c,()=>d.none());return{keydown:f=>u.handleKeydown(e,f),keyup:f=>u.handleKeyup(e,f),focus:f=>u.handleFocus(e,f)}},pe=e=>(t,n,o)=>{const s=e(t);return _t(s,t,n,o)},Ot=(e,t)=>{const n=le(e,t);return pe(n)},It=(e,t)=>{const n=le(t,e);return pe(n)},_t=(e,t,n,o)=>o.focusManager.get(t).bind(a=>e(t,a,o)).map(a=>(o.focusManager.set(t,a),!0)),$t=(e,t)=>Z(e,t).map(n=>({index:n,candidates:e})),Vt=(e,t,n)=>{const o=y=>z(y,t),s=G(e,n),a=ee(s,Tt);return $t(a,o)},we=(e,t,n,o,s)=>{const a=r=>ce(r)==="button"&&q(r,"disabled")==="disabled",y=(r,l,c)=>s(r,l,o,0,c.length-1,c[l],u=>a(c[u])?y(r,u,c):d.from(c[u]));return Vt(e,n,t).bind(r=>{const l=r.index,c=r.candidates;return y(l,l,c)})},Ut=(e,t,n,o)=>we(e,t,n,o,(s,a,y,r,l,c,u)=>{const f=Oe(a+y,r,l);return f===s?d.from(c):u(f)}),zt=(e,t,n,o)=>we(e,t,n,o,(s,a,y,r,l,c,u)=>{const f=Ae(a,y,r,l);return f===s?d.none():u(f)}),Bt=(e,t)=>{const n=h=>(h.dom.click(),d.some(!0)),o=(h,E)=>E.closest?E.focusManager.get(h).bind(p=>ie(p,E.selector)):E.focusManager.get(h),s=(h,E,p)=>o(h,p).bind(g=>p.execute(g)),a=(h,E,p)=>o(h,p).bind(g=>p.escape(g)),y=(h,E)=>{Nt(h,E.selector).each(p=>{E.focusManager.set(h,p)})},r=h=>(E,p,g)=>(g.cycles?zt:Ut)(E,g.selector,p,h),l=r(-1),c=r(1),u=h=>(E,p,g)=>h(E,p,g),f=(h,E,p)=>{const g=[...p.allowHorizontal?fe:[]].concat(p.allowVertical?ye:[]),C=[...p.allowHorizontal?he:[]].concat(p.allowVertical?W:[]);return[m(i(g),u(Ot(l,c))),m(i(C),u(It(l,c))),m(i(k),s),m(i(N),s),m(i(O),a)]},T=v([]),S={execute:n,escape:v(d.none()),allowVertical:!0,allowHorizontal:!0,cycles:!0,focusIn:!1,closest:!0,...t},_=F(S,f,T,()=>te(S.focusIn,y));return{keydown:h=>_.handleKeydown(e,h),keyup:h=>_.handleKeyup(e,h),focus:h=>_.handleFocus(e,h)}},qt=(e,t)=>{const n=(r,l,c)=>[m(D([P,i(k)]),c.onShiftEnter),m(D([X,i(k)]),c.onEnter),m(D([P,i(b)]),c.onShiftTab),m(D([X,i(b)]),c.onTab),m(i(ye),c.onUp),m(i(W),c.onDown),m(i(fe),c.onLeft),m(i(he),c.onRight),m(i(N),c.onSpace)],o=(r,l,c)=>[m(i(O),c.onEscape)],s=r=>()=>L(r)?(r(),d.some(!0)):d.none(),a={onSpace:s(t.onSpace),onEnter:s(t.onEnter),onShiftEnter:s(t.onShiftEnter),onTab:s(t.onTab),onShiftTab:s(t.onShiftTab),onLeft:s(t.onLeft),onRight:s(t.onRight),onUp:s(t.onUp),onDown:s(t.onDown),onEscape:s(t.onEscape)},y=F(a,n,o,()=>d.none());return{keydown:r=>y.handleKeydown(e,r),keyup:r=>y.handleKeyup(e,r),focus:r=>y.handleFocus(e,r)}},jt=(e,t,n)=>{const o=$(e.slice(0,t)),s=$(e.slice(t+1));return x(o.concat(s),n)},Gt=(e,t,n)=>{const o=$(e.slice(0,t));return x(o,n)},Wt=(e,t,n)=>{const o=e.slice(0,t),s=e.slice(t+1);return x(s.concat(o),n)},Ct=(e,t,n)=>{const o=e.slice(t+1);return x(o,n)},Xt=e=>gt(e)>0,Jt=(e,t)=>{const n=G(e,t.selector),o=ee(n,s=>Xt(s));return d.from(o[t.firstTabstop])},I=(e,t)=>t.closest?t.focusManager.get(e).bind(n=>ie(n,t.selector)):t.focusManager.get(e),Qt=(e,t)=>e.useTabstopAt(t),Yt=e=>ot(e).bind(rt).exists(t=>z(t,e)),Zt=(e,t)=>{Jt(e,t).each(n=>t.focusManager.set(e,n))},en=(e,t,n,o,s)=>s(t,n,a=>Qt(o,a)).fold(()=>o.cyclic?d.some(!0):d.none(),a=>(o.focusManager.set(e,a),d.some(!0))),Ee=(e,t,n,o)=>{const s=G(e,n.selector);return I(e,n).bind(a=>Z(s,Ke(z,a)).bind(r=>en(e,s,r,n,o)))},ge=(e,t,n)=>{const o=n.cyclic?jt:Gt;return Ee(e,t,n,o)},ve=(e,t,n)=>{const o=n.cyclic?Wt:Ct;return Ee(e,t,n,o)},tn=(e,t,n)=>I(e,n).filter(o=>!n.useTabstopAt(o)).bind(o=>(Yt(o)?ge:ve)(e,t,n)),Q=(e,t,n)=>I(e,n).bind(o=>n.execute(o)),nn=(e,t,n)=>I(e,n).bind(o=>n.escape(o)),on=v([m(D([P,i(b)]),ge),m(i(b),ve),m(i(k),Q),m(i(N),Q),m(i(O),nn)]),sn=v([m(i(b),tn)]),rn=(e,t)=>{const n={execute:v(d.none()),escape:v(d.none()),firstTabstop:0,useTabstopAt:Me,cyclic:!0,focusIn:!1,closest:!0,...t},o=F(n,on,sn,()=>te(n.focusIn,Zt));return{keydown:s=>o.handleKeydown(e,s),keyup:s=>o.handleKeyup(e,s),focus:s=>o.handleFocus(e,s)}},H=(e,t)=>(e?.addEventListener("keydown",t.keydown),e?.addEventListener("keyup",t.keyup),e?.addEventListener("focus",t.focus),()=>{e?.removeEventListener("keydown",t.keydown),e?.removeEventListener("keyup",t.keyup),e?.removeEventListener("focus",t.focus)}),En=e=>{M.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=rn(w.fromDom(t.current),e);return H(t.current,n)}else return K},[e])},gn=e=>{M.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=Bt(w.fromDom(t.current),e);return H(t.current,n)}else return K},[e])},vn=e=>{M.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=qt(w.fromDom(t.current),e);return H(t.current,n)}else return K},[e])},Tn=e=>{M.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=At(w.fromDom(t.current),e);return H(t.current,n)}else return K},[])},Sn=e=>{M.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=Rt(w.fromDom(t.current),e);return H(t.current,n)}else return K},[e])};export{w as S,wn as a,Tn as b,gn as c,q as d,Nt as e,rt as f,V as g,hn as h,yn as i,vn as j,En as k,G as l,mn as m,ie as n,fn as o,nt as p,z as q,ln as r,pn as s,Sn as u};
