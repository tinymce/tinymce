import{r as i,j as M}from"./iframe-Bp28YkvC.js";import{f as z,O as L}from"./Optional-CilDcsXt.js";import{c as j}from"./Fun--VEwoXIw.js";const $=t=>t==="top-left",k=t=>t==="top-right",q=t=>t==="bottom-left",B=t=>$(t)||q(t),N=t=>$(t)||k(t),T=(t,e)=>({deltaX:e.x-t.x,deltaY:e.y-t.y}),S=(t,e,n)=>Math.min(n,Math.max(e,t)),W=(t,e,n)=>{const r=t.x+t.width,a=t.y+t.height;return{x:Math.round(B(n)?t.x:e.width-r),y:Math.round(N(n)?t.y:e.height-a)}},X=(t,e,n,r)=>{const{upperLeftCorner:a,bottomRightCorner:o}=n,u=t.x+t.width,s=t.y+t.height;return{x:{min:Math.ceil(a.x+(e.x-t.x))-r.horizontal,max:Math.floor(o.x-(u-e.x))+r.horizontal},y:{min:Math.ceil(a.y+(e.y-t.y))-r.vertical,max:Math.floor(o.y-(s-e.y))+r.vertical}}},H=i.createContext(null),Y=()=>{const t=i.useContext(H);if(t===null)throw new Error("Draggable compound components must be rendered within the Draggable component");return t},O=t=>`translate3d(${t.x}px, ${t.y}px, 0px)`,D=t=>({x:z(t.x)?`${t.x}px`:t.x,y:z(t.y)?`${t.y}px`:t.y}),w=(t,e,n,r)=>{const{x:a,y:o}=r.fold(j(t),({width:u,height:s})=>{let m=t.x,x=t.y;if(e.horizontal<1){let d;if(e.horizontal>0){const f=(1-e.horizontal).toFixed(2);d=`${u} * ${f}`}else d=`${u}`;m=`min( ${t.x}, calc( 100% - ${d} ) )`}if(e.vertical<1){let d;if(e.vertical>0){const f=(1-e.vertical).toFixed(2);d=`${s} * ${f}`}else d=`${s}`;x=`min( ${t.y}, calc( 100% - ${d} ) )`}return{x:m,y:x}});return $(n)?{top:o,left:a}:k(n)?{top:o,right:a}:q(n)?{bottom:o,left:a}:{bottom:o,right:a}},F=(t,e,n,r,a,o)=>a?{transform:O(t),...w(D(e),r,n,o)}:w(D(e),r,n,o),E=i.forwardRef(({children:t,style:e,origin:n="top-left",initialPosition:r={x:0,y:0},declaredSize:a,onDragStart:o,onDragEnd:u,...s},m)=>{const[x,d]=i.useState({x:0,y:0}),[f,h]=i.useState(r),[p,R]=i.useState(!1),b=i.useRef(null),y=i.useMemo(()=>{var l,g;return{horizontal:((l=s.allowedOverflow)==null?void 0:l.horizontal)??0,vertical:((g=s.allowedOverflow)==null?void 0:g.vertical)??0}},[s.allowedOverflow]),C=F(x,f,n,y,p,L.from(a)),P=i.useMemo(()=>({setShift:d,draggableRef:b,isDragging:p,setIsDragging:R,setPosition:h,allowedOverflow:y,origin:n,onDragStart:o,onDragEnd:u}),[p,y,n,o,u]),c=i.useCallback(l=>{typeof m=="function"?m(l):m&&(m.current=l),b.current=l},[m]);return M.jsx(H.Provider,{value:P,children:M.jsx("div",{ref:c,style:{...e,...C},...s,children:t})})}),V=({children:t})=>{const e=i.useRef(null),n=i.useRef({x:0,y:0}),r=i.useRef({x:{min:0,max:0},y:{min:0,max:0}}),{setShift:a,draggableRef:o,isDragging:u,setIsDragging:s,setPosition:m,allowedOverflow:x,origin:d,onDragStart:f,onDragEnd:h}=Y(),p=i.useCallback(()=>{if(s(!1),h==null||h(),a({x:0,y:0}),o.current!==null){const c=o.current.getBoundingClientRect(),l={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};m(W(c,l,d))}},[s,a,o,m,d,h]),R=i.useCallback(c=>{if(o.current===null)return;s(!0),f==null||f(),e.current=c.target,e.current.setPointerCapture(c.pointerId);const l={x:Math.round(c.clientX),y:Math.round(c.clientY)};n.current=l;const g=o.current.getBoundingClientRect(),v={horizontal:Math.round(g.width*x.horizontal),vertical:Math.round(g.height*x.vertical)},_={upperLeftCorner:{x:0,y:0},bottomRightCorner:{x:document.documentElement.clientWidth,y:document.documentElement.clientHeight}};r.current=X(g,l,_,v)},[o,s,x,f]),b=i.useCallback(c=>{if(u){c.preventDefault();const l={x:S(Math.round(c.clientX),r.current.x.min,r.current.x.max),y:S(Math.round(c.clientY),r.current.y.min,r.current.y.max)},{deltaX:g,deltaY:v}=T(n.current,l);n.current=l,a(({x:_,y:I})=>({x:_+g,y:I+v}))}},[u,a]),y=i.useCallback(c=>{var l;(l=e.current)==null||l.releasePointerCapture(c.pointerId),p()},[p]),C=i.useCallback(()=>{u&&p()},[p,u]),P=u?{cursor:"grabbing",userSelect:"none",WebkitUserSelect:"none"}:{cursor:"grab"};return M.jsx("div",{onPointerDown:R,onPointerUp:y,onPointerMove:b,onLostPointerCapture:C,style:P,children:t})};try{E.displayName="Root",E.__docgenInfo={description:"",displayName:"Root",props:{popover:{defaultValue:null,description:"",name:"popover",required:!1,type:{name:'"auto" | "hint" | "manual"'}},origin:{defaultValue:{value:"top-left"},description:"",name:"origin",required:!1,type:{name:"Origin"}},initialPosition:{defaultValue:{value:"{ x: 0, y: 0 }"},description:"",name:"initialPosition",required:!1,type:{name:"CssPosition"}},declaredSize:{defaultValue:null,description:"",name:"declaredSize",required:!1,type:{name:"CssSize"}},allowedOverflow:{defaultValue:null,description:"",name:"allowedOverflow",required:!1,type:{name:"Partial<AllowedOverflow>"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!1,type:{name:"(() => void)"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"(() => void)"}}}}}catch{}try{V.displayName="Handle",V.__docgenInfo={description:"",displayName:"Handle",props:{}}}catch{}export{V as H,E as R};
