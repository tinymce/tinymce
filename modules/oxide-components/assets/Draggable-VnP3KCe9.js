import{r as i,j as D}from"./iframe-CD0Rh_Wl.js";import{f as S,O as L}from"./Optional-DbTLtGQT.js";import{c as j}from"./Fun--VEwoXIw.js";const M=t=>t==="top-left",k=t=>t==="top-right",q=t=>t==="bottom-left",B=t=>M(t)||q(t),N=t=>M(t)||k(t),T=(t,e)=>({deltaX:e.x-t.x,deltaY:e.y-t.y}),$=(t,e,n)=>Math.min(n,Math.max(e,t)),W=(t,e,n)=>{const r=t.x+t.width,a=t.y+t.height;return{x:Math.round(B(n)?t.x:e.width-r),y:Math.round(N(n)?t.y:e.height-a)}},X=(t,e,n,r)=>{const{upperLeftCorner:a,bottomRightCorner:o}=n,c=t.x+t.width,l=t.y+t.height;return{x:{min:Math.ceil(a.x+(e.x-t.x))-r.horizontal,max:Math.floor(o.x-(c-e.x))+r.horizontal},y:{min:Math.ceil(a.y+(e.y-t.y))-r.vertical,max:Math.floor(o.y-(l-e.y))+r.vertical}}},H=i.createContext(null),Y=()=>{const t=i.useContext(H);if(t===null)throw new Error("Draggable compound components must be rendered within the Draggable component");return t},O=t=>`translate3d(${t.x}px, ${t.y}px, 0px)`,z=t=>({x:S(t.x)?`${t.x}px`:t.x,y:S(t.y)?`${t.y}px`:t.y}),E=(t,e,n,r)=>{const{x:a,y:o}=r.fold(j(t),({width:c,height:l})=>{let d=t.x,f=t.y;if(e.horizontal<1){let u;if(e.horizontal>0){const g=(1-e.horizontal).toFixed(2);u=`${c} * ${g}`}else u=`${c}`;d=`min( ${t.x}, calc( 100% - ${u} ) )`}if(e.vertical<1){let u;if(e.vertical>0){const g=(1-e.vertical).toFixed(2);u=`${l} * ${g}`}else u=`${l}`;f=`min( ${t.y}, calc( 100% - ${u} ) )`}return{x:d,y:f}});return M(n)?{top:o,left:a}:k(n)?{top:o,right:a}:q(n)?{bottom:o,left:a}:{bottom:o,right:a}},F=(t,e,n,r,a,o)=>a?{transform:O(t),...E(z(e),r,n,o)}:E(z(e),r,n,o),w=i.forwardRef(({children:t,style:e,origin:n="top-left",initialPosition:r={x:0,y:0},declaredSize:a,onDragStart:o,onDragEnd:c,...l},d)=>{const[f,u]=i.useState({x:0,y:0}),[g,y]=i.useState(r),[x,R]=i.useState(!1),b=i.useRef(null),p=i.useMemo(()=>({horizontal:l.allowedOverflow?.horizontal??0,vertical:l.allowedOverflow?.vertical??0}),[l.allowedOverflow]),C=F(f,g,n,p,x,L.from(a)),P=i.useMemo(()=>({setShift:u,draggableRef:b,isDragging:x,setIsDragging:R,setPosition:y,allowedOverflow:p,origin:n,onDragStart:o,onDragEnd:c}),[x,p,n,o,c]),s=i.useCallback(m=>{typeof d=="function"?d(m):d&&(d.current=m),b.current=m},[d]);return D.jsx(H.Provider,{value:P,children:D.jsx("div",{ref:s,style:{...e,...C},...l,children:t})})}),V=({children:t})=>{const e=i.useRef(null),n=i.useRef({x:0,y:0}),r=i.useRef({x:{min:0,max:0},y:{min:0,max:0}}),{setShift:a,draggableRef:o,isDragging:c,setIsDragging:l,setPosition:d,allowedOverflow:f,origin:u,onDragStart:g,onDragEnd:y}=Y(),x=i.useCallback(()=>{if(l(!1),y?.(),a({x:0,y:0}),o.current!==null){const s=o.current.getBoundingClientRect(),m={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};d(W(s,m,u))}},[l,a,o,d,u,y]),R=i.useCallback(s=>{if(o.current===null)return;l(!0),g?.(),e.current=s.target,e.current.setPointerCapture(s.pointerId);const m={x:Math.round(s.clientX),y:Math.round(s.clientY)};n.current=m;const h=o.current.getBoundingClientRect(),v={horizontal:Math.round(h.width*f.horizontal),vertical:Math.round(h.height*f.vertical)},_={upperLeftCorner:{x:0,y:0},bottomRightCorner:{x:document.documentElement.clientWidth,y:document.documentElement.clientHeight}};r.current=X(h,m,_,v)},[o,l,f,g]),b=i.useCallback(s=>{if(c){s.preventDefault();const m={x:$(Math.round(s.clientX),r.current.x.min,r.current.x.max),y:$(Math.round(s.clientY),r.current.y.min,r.current.y.max)},{deltaX:h,deltaY:v}=T(n.current,m);n.current=m,a(({x:_,y:I})=>({x:_+h,y:I+v}))}},[c,a]),p=i.useCallback(s=>{e.current?.releasePointerCapture(s.pointerId),x()},[x]),C=i.useCallback(()=>{c&&x()},[x,c]),P=c?{cursor:"grabbing",userSelect:"none",WebkitUserSelect:"none"}:{cursor:"grab"};return D.jsx("div",{onPointerDown:R,onPointerUp:p,onPointerMove:b,onLostPointerCapture:C,style:P,children:t})};try{w.displayName="Root",w.__docgenInfo={description:"",displayName:"Root",props:{popover:{defaultValue:null,description:"",name:"popover",required:!1,type:{name:'"auto" | "hint" | "manual"'}},origin:{defaultValue:{value:"top-left"},description:"",name:"origin",required:!1,type:{name:"Origin"}},initialPosition:{defaultValue:{value:"{ x: 0, y: 0 }"},description:"",name:"initialPosition",required:!1,type:{name:"CssPosition"}},declaredSize:{defaultValue:null,description:"",name:"declaredSize",required:!1,type:{name:"CssSize"}},allowedOverflow:{defaultValue:null,description:"",name:"allowedOverflow",required:!1,type:{name:"Partial<AllowedOverflow>"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!1,type:{name:"(() => void)"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"(() => void)"}}}}}catch{}try{V.displayName="Handle",V.__docgenInfo={description:"",displayName:"Handle",props:{}}}catch{}export{V as H,w as R};
