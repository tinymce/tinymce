import{r as l,j as N}from"./iframe-CWoD32K7.js";import"./UniverseProvider-B0Up_XOP.js";import{b as S}from"./Bem-BaJhmSJn.js";import{e as I,c as T,i as v,b as $}from"./Optional-DbTLtGQT.js";import{e as O}from"./Obj-DUQpguIS.js";const V=(e,o)=>{let t=null;const s=()=>{I(t)||(clearTimeout(t),t=null)};return{cancel:s,throttle:(...p)=>{s(),t=setTimeout(()=>{t=null,e.apply(null,p)},o)}}},k=l.createContext(null),H=()=>{const e=l.useContext(k);if(e===null)throw new Error("Dropdown compound components must be rendered within the Dropdown component");return e},W=(e,o,t)=>e==="top"?o.top-t.top:t.bottom-o.bottom,q=(e,o,t)=>e==="left"?o.left-t.left:t.right-o.right,D=({anchorRect:e,anchoredContainerRect:o,side:t,align:s,gap:i,boundaryRect:p=document.documentElement.getBoundingClientRect()})=>{if(t==="top"||t==="bottom"){const n=W(t,e,p),a=t==="top"?e.top-o.height-i:e.bottom+i;let r=e.left;return s==="center"&&(r=e.left+e.width/2-o.width/2),s==="end"&&(r=e.right-o.width),{maxHeight:`${n}px`,top:`${a}px`,left:`${r}px`,minWidth:`${e.width}px`}}if(t==="left"||t==="right"){const n=q(t,e,p),a=t==="left"?e.left-o.width-i:e.right+i;let r=e.top;return s==="center"&&(r=e.top-o.width/2+e.width/2),s==="end"&&(r=e.bottom-o.height),{maxWidth:`${n}px`,top:`${r}px`,left:`${a}px`,minWidth:`${e.width}px`}}return{}},M=(e,o)=>e.current?.contains(o)??!1,b=l.forwardRef(({children:e,onOpenChange:o,...t},s)=>{const{triggerRef:i,side:p,align:n,gap:a,contentRef:r,triggerEvents:u,debouncedHideHoverablePopover:g,isOpen:m,setIsOpen:x}=H(),[L,y]=l.useState({opacity:"0"}),E=l.useCallback(c=>{x(c.newState==="open")},[x]),w=l.useCallback(()=>{if(v(i.current)&&v(r.current)){const c=document.documentElement.getBoundingClientRect(),d=i.current.getBoundingClientRect(),f=r.current.getBoundingClientRect(),h={opacity:"1",...D({anchorRect:d,anchoredContainerRect:f,side:p,align:n,gap:a,boundaryRect:c})};y(_=>O(h,_)?_:h)}},[r,i,n,p,a]);return l.useEffect(()=>{const c=r.current;if($(c))return;const d=f=>{E(f),f.newState==="closed"?((r.current?.contains(document.activeElement)||document.activeElement===document.body)&&i.current?.focus(),o?.(!1)):o?.(!0)};return c.addEventListener("toggle",d),()=>{c.removeEventListener("toggle",d)}},[r,i,E,o]),l.useEffect(()=>{m?w():y({opacity:"0"})},[m,w,e]),l.useEffect(()=>{const c=()=>{r.current?.hidePopover()},d=f=>{(!(f.target instanceof Node)||!M(r,f.target))&&r.current?.hidePopover()};return window.addEventListener("scroll",d,!0),window.addEventListener("resize",c),()=>{window.removeEventListener("scroll",d,!0),window.removeEventListener("resize",c)}},[w,i,r]),N.jsx("div",{popover:"auto",className:S("tox-dropdown-content"),ref:c=>{r.current=c,T(s)?s(c):v(s)&&(s.current=c)},style:{...L},...u.includes("hover")&&{onMouseLeave:g.throttle,onMouseEnter:()=>g.cancel()},...t,children:m&&e})}),C=({children:e})=>{const{triggerRef:o,contentRef:t,triggerEvents:s,debouncedHideHoverablePopover:i,isOpen:p}=H();let n=l.Children.toArray(e)[0];if(!l.isValidElement(n))return null;n=n;const a={onMouseEnter:u=>{n.props.onMouseEnter?.(u),i.cancel(),t.current?.showPopover()},onMouseLeave:u=>{n.props.onMouseLeave?.(u),i.throttle(u)}},r={onClick:u=>{n.props.onClick?.(u),p?t.current?.hidePopover():t.current?.showPopover()}};return l.cloneElement(n,{ref:u=>{o.current=u,T(n.props.ref)?n.props.ref(u):v(n.props.ref)&&(n.props.ref.current=u)},...s.includes("click")&&r,...s.includes("hover")&&a})},P=({children:e,side:o="top",align:t="start",gap:s=8,triggerEvents:i=["click"]})=>{const p=l.useRef(),n=l.useRef(),[a,r]=l.useState(!1),u=l.useMemo(()=>V(m=>{(!(m.relatedTarget instanceof Node)||!M(n,m.relatedTarget))&&n.current?.hidePopover()},300),[]),g=l.useMemo(()=>({triggerRef:p,contentRef:n,side:o,align:t,gap:s,triggerEvents:i,debouncedHideHoverablePopover:u,isOpen:a,setIsOpen:r}),[p,n,o,t,s,i,u,a]);return N.jsx(k.Provider,{value:g,children:e})};try{P.displayName="Root",P.__docgenInfo={description:"",displayName:"Root",props:{side:{defaultValue:{value:"top"},description:"",name:"side",required:!1,type:{name:'"left" | "right" | "top" | "bottom"'}},align:{defaultValue:{value:"start"},description:"",name:"align",required:!1,type:{name:'"start" | "end" | "center"'}},gap:{defaultValue:{value:"8"},description:"",name:"gap",required:!1,type:{name:"number"}},triggerEvents:{defaultValue:{value:"[ 'click' ]"},description:"",name:"triggerEvents",required:!1,type:{name:'("click" | "hover")[]'}}}}}catch{}try{b.displayName="Content",b.__docgenInfo={description:"",displayName:"Content",props:{onOpenChange:{defaultValue:null,description:"",name:"onOpenChange",required:!1,type:{name:"((isOpen: boolean) => void)"}}}}}catch{}try{C.displayName="Trigger",C.__docgenInfo={description:"",displayName:"Trigger",props:{}}}catch{}export{b as C,P as R,C as T};
