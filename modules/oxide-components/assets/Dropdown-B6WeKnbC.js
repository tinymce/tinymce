import{r as l,j as N}from"./iframe-C0-6l9sN.js";import{d as L,e as T,i as v,b as S}from"./Optional-CuHnBc-7.js";import{e as $}from"./Obj-BYXNADYo.js";import{b as V}from"./Bem-By0_poOi.js";const q=(e,o)=>{let t=null;const s=()=>{L(t)||(clearTimeout(t),t=null)};return{cancel:s,throttle:(...c)=>{s(),t=setTimeout(()=>{t=null,e.apply(null,c)},o)}}},k=l.createContext(null),H=()=>{const e=l.useContext(k);if(e===null)throw new Error("Dropdown compound components must be rendered within the Dropdown component");return e},I=(e,o,t)=>e==="top"?o.top-t.top:t.bottom-o.bottom,D=(e,o,t)=>e==="left"?o.left-t.left:t.right-o.right,O=({anchorRect:e,anchoredContainerRect:o,side:t,align:s,gap:i,boundaryRect:c=document.documentElement.getBoundingClientRect()})=>{if(t==="top"||t==="bottom"){const n=I(t,e,c),d=t==="top"?e.top-o.height-i:e.bottom+i;let r=e.left;return s==="center"&&(r=e.left+e.width/2-o.width/2),s==="end"&&(r=e.right-o.width),{maxHeight:`${n}px`,top:`${d}px`,left:`${r}px`,minWidth:`${e.width}px`}}if(t==="left"||t==="right"){const n=D(t,e,c),d=t==="left"?e.left-o.width-i:e.right+i;let r=e.top;return s==="center"&&(r=e.top-o.width/2+e.width/2),s==="end"&&(r=e.bottom-o.height),{maxWidth:`${n}px`,top:`${r}px`,left:`${d}px`,minWidth:`${e.width}px`}}return{}},W=(e,o)=>e.current?.contains(o)??!1,b=l.forwardRef(({children:e,onClose:o,...t},s)=>{const{triggerRef:i,side:c,align:n,gap:d,contentRef:r,triggerEvents:p,debouncedHideHoverablePopover:f,isOpen:a,setIsOpen:h}=H(),[M,x]=l.useState({opacity:"0"}),y=l.useCallback(u=>{h(u.newState==="open")},[h]),w=l.useCallback(()=>{if(v(i.current)&&v(r.current)){const u=document.documentElement.getBoundingClientRect(),m=i.current.getBoundingClientRect(),g=r.current.getBoundingClientRect(),_={opacity:"1",...O({anchorRect:m,anchoredContainerRect:g,side:c,align:n,gap:d,boundaryRect:u})};x(E=>$(_,E)?E:_)}},[r,i,n,c,d]);return l.useEffect(()=>{const u=r.current;if(S(u))return;const m=g=>{y(g),g.newState==="closed"&&(i.current?.focus(),o?.())};return u.addEventListener("toggle",m),()=>{u.removeEventListener("toggle",m)}},[r,i,y,o]),l.useEffect(()=>{a?w():x({opacity:"0"})},[a,w,e]),l.useEffect(()=>{const u=()=>{r.current?.hidePopover()};return window.addEventListener("scroll",u,!0),window.addEventListener("resize",u),()=>{window.removeEventListener("scroll",u,!0),window.removeEventListener("resize",u)}},[w,i,r]),N.jsx("div",{popover:"auto",className:V("tox-dropdown-content"),ref:u=>{r.current=u,T(s)?s(u):v(s)&&(s.current=u)},style:{...M},...p.includes("hover")&&{onMouseLeave:f.throttle,onMouseEnter:()=>f.cancel()},...t,children:a&&e})}),C=({children:e})=>{const{triggerRef:o,contentRef:t,triggerEvents:s,debouncedHideHoverablePopover:i,isOpen:c}=H();let n=l.Children.toArray(e)[0];if(!l.isValidElement(n))return null;n=n;const d={onMouseEnter:p=>{n.props.onMouseEnter?.(p),i.cancel(),t.current?.showPopover()},onMouseLeave:p=>{n.props.onMouseLeave?.(p),i.throttle(p)}},r={onClick:p=>{n.props.onClick?.(p),c?t.current?.hidePopover():t.current?.showPopover()}};return l.cloneElement(n,{ref:p=>{o.current=p,T(n.props.ref)?n.props.ref(p):v(n.props.ref)&&(n.props.ref.current=p)},...s.includes("click")&&r,...s.includes("hover")&&d})},P=({children:e,side:o="top",align:t="start",gap:s=8,triggerEvents:i=["click"]})=>{const c=l.useRef(),n=l.useRef(),[d,r]=l.useState(!1),p=l.useMemo(()=>q(a=>{(!(a.relatedTarget instanceof Node)||!W(n,a.relatedTarget))&&n.current?.hidePopover()},300),[]),f=l.useMemo(()=>({triggerRef:c,contentRef:n,side:o,align:t,gap:s,triggerEvents:i,debouncedHideHoverablePopover:p,isOpen:d,setIsOpen:r}),[c,n,o,t,s,i,p,d]);return N.jsx(k.Provider,{value:f,children:e})};try{P.displayName="Root",P.__docgenInfo={description:"",displayName:"Root",props:{side:{defaultValue:{value:"top"},description:"",name:"side",required:!1,type:{name:'"top" | "bottom" | "left" | "right"'}},align:{defaultValue:{value:"start"},description:"",name:"align",required:!1,type:{name:'"start" | "center" | "end"'}},gap:{defaultValue:{value:"8"},description:"",name:"gap",required:!1,type:{name:"number"}},triggerEvents:{defaultValue:{value:"[ 'click' ]"},description:"",name:"triggerEvents",required:!1,type:{name:'("click" | "hover")[]'}}}}}catch{}try{b.displayName="Content",b.__docgenInfo={description:"",displayName:"Content",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}try{C.displayName="Trigger",C.__docgenInfo={description:"",displayName:"Trigger",props:{}}}catch{}export{b as C,P as R,C as T};
