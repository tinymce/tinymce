var ae=Object.defineProperty;var le=(e,t,n)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var M=(e,t,n)=>le(e,typeof t!="symbol"?t+"":t,n);import{r as E,j as i}from"./iframe-Cqy9OkYT.js";import{i as G,a as V}from"./Type-DK8IqPft.js";import{n as X,a as ue,c as I,b as ie}from"./Fun-DhDWU5Ah.js";const g=class g{constructor(t,n){M(this,"tag");M(this,"value");this.tag=t,this.value=n}static some(t){return new g(!0,t)}static none(){return g.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?g.some(t(this.value)):g.none()}bind(t){return this.tag?t(this.value):g.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:g.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return G(t)?g.some(t):g.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};M(g,"singletonNone",new g(!1));let a=g;const de=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];if(t(s,n))return!0}return!1},me=(e,t)=>{const n=e.length,o=new Array(n);for(let s=0;s<n;s++){const r=e[s];o[s]=t(r,s)}return o},fe=(e,t)=>{const n=[];for(let o=0,s=e.length;o<s;o++){const r=e[o];t(r,o)&&n.push(r)}return n},he=(e,t,n)=>{for(let o=0,s=e.length;o<s;o++){const r=e[o];if(t(r,o))return a.some(r);if(n(r,o))break}return a.none()},ye=(e,t)=>he(e,t,X),pe=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];if(t(s,n))return a.some(n)}return a.none()},ge=(e,t,n,o)=>{const s=e+t;return s>o?n:s<n?o:s},we=(e,t,n)=>Math.min(Math.max(e,t),n),ve=(e,t)=>e?a.some(t):a.none(),Ee=(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const s="HTML does not have a single root node";throw console.error(s,e),new Error(s)}return D(o.childNodes[0])},xe=(e,t)=>{const o=(t||document).createElement(e);return D(o)},be=(e,t)=>{const o=(t||document).createTextNode(e);return D(o)},D=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},ke=(e,t,n)=>a.from(e.dom.elementFromPoint(t,n)).map(D),v={fromHtml:Ee,fromTag:xe,fromText:be,fromDom:D,fromPoint:ke},Te=9,J=11,Q=1,De=3,Y=(e,t)=>{const n=e.dom;if(n.nodeType!==Q)return!1;{const o=n;if(o.matches!==void 0)return o.matches(t);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(t);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(t);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Z=e=>e.nodeType!==Q&&e.nodeType!==Te&&e.nodeType!==J||e.childElementCount===0,Ne=(e,t)=>{const n=t===void 0?document:t.dom;return Z(n)?[]:me(n.querySelectorAll(e),v.fromDom)},Me=(e,t)=>{const n=t===void 0?document:t.dom;return Z(n)?a.none():a.from(n.querySelector(e)).map(v.fromDom)},Se=(e,t)=>e.dom===t.dom,Re=e=>e.dom.nodeName.toLowerCase(),je=e=>e.dom.nodeType,ee=e=>t=>je(t)===e,He=ee(De),Le=ee(J),Fe=e=>Le(e)&&G(e.dom.host),te=e=>v.fromDom(e.dom.getRootNode()),Ie=e=>{const t=te(e);return Fe(t)?a.some(t):a.none()},Oe=e=>v.fromDom(e.dom.host),Ve=()=>v.fromDom(document),qe=(e=Ve())=>a.from(e.dom.activeElement).map(v.fromDom),Ke=e=>qe(te(e)).filter(t=>e.dom.contains(t.dom)),_e=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},Ae=e=>e.style!==void 0&&V(e.style.getPropertyValue),ne=e=>{const t=He(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return Ie(v.fromDom(t)).fold(()=>n.body.contains(t),ue(ne,Oe))},Ce=(e,t)=>{const n=e.dom,s=window.getComputedStyle(n).getPropertyValue(t);return s===""&&!ne(e)?Pe(n,t):s},Pe=(e,t)=>Ae(e)?e.style.getPropertyValue(t):"",ze=e=>e.offsetWidth<=0&&e.offsetHeight<=0,We=e=>!ze(e.dom),oe=(e,t)=>n=>Ue(n)==="rtl"?t:e,Ue=e=>Ce(e,"direction")==="rtl"?"rtl":"ltr",Be=(e,t,n,o,s)=>e(n,o)?a.some(n):V(s)&&s(n)?a.none():t(n,o,s),$e=(e,t,n)=>{let o=e.dom;const s=V(n)?n:X;for(;o.parentNode;){o=o.parentNode;const r=v.fromDom(o);if(t(r))return a.some(r);if(s(r))break}return a.none()},Ge=(e,t,n)=>$e(e,o=>Y(o,t),n),Xe=(e,t)=>Me(t,e),Je=(e,t,n)=>Be((s,r)=>Y(s,r),Ge,e,t,n),Qe=(e,t)=>Ne(t,e),se=e=>(t,n,o)=>{const s=e(t);return et(s,t,n,o)},Ye=(e,t)=>{const n=oe(e,t);return se(n)},Ze=(e,t)=>{const n=oe(t,e);return se(n)},et=(e,t,n,o)=>o.focusManager.get(t).bind(r=>e(t,r,o)).map(r=>(o.focusManager.set(t,r),!0)),tt=(e,t)=>pe(e,t).map(n=>({index:n,candidates:e})),nt=(e,t,n)=>{const o=y=>Se(y,t),s=Qe(e,n),r=fe(s,We);return tt(r,o)},re=(e,t,n,o,s)=>{const r=d=>Re(d)==="button"&&_e(d,"disabled")==="disabled",y=(d,f,l)=>s(d,f,o,0,l.length-1,l[f],c=>r(l[c])?y(d,c,l):a.from(l[c]));return nt(e,n,t).bind(d=>{const f=d.index,l=d.candidates;return y(f,f,l)})},ot=(e,t,n,o)=>re(e,t,n,o,(s,r,y,d,f,l,c)=>{const p=we(r+y,d,f);return p===s?a.from(l):c(p)}),st=(e,t,n,o)=>re(e,t,n,o,(s,r,y,d,f,l,c)=>{const p=ge(r,y,d,f);return p===s?a.none():c(p)}),rt=()=>({get:n=>Ke(n),set:(n,o)=>{o.dom.focus()}});var ce=(e=>(e.OnFocusMode="onFocus",e))(ce||{});const x=e=>t=>de(e,n=>n.code===t.code||n.key===t.key||n.which===t.which),b=(e,t)=>({matches:e,classification:t}),ct=(e,t)=>ye(e,o=>o.matches(t)).map(o=>o.classification),at=(e,t,n,o)=>{const s={...e,focusManager:rt(),focusInside:ce.OnFocusMode,focusIn:o},r=(l,c,p)=>{const L=p(l,c,s);return ct(L,c).bind(N=>N(l,c,s))};return{handleKeydown:(l,c)=>r(l,c,t).each(p=>{c.preventDefault(),c.stopPropagation()}),handleKeyup:(l,c)=>r(l,c,n).each(()=>{c.preventDefault(),c.stopPropagation()}),handleFocus:(l,c)=>{o(s).each(p=>{p(l,s),c.preventDefault(),c.stopPropagation()})}}},lt=[{code:"Enter",key:"Enter",which:13}],ut=[{code:"ArrowLeft",key:"ArrowLeft",which:37}],it=[{code:"ArrowUp",key:"ArrowUp",which:38}],dt=[{code:"ArrowRight",key:"ArrowRight",which:39}],mt=[{code:"ArrowDown",key:"ArrowDown",which:40}],ft=[{code:"Space",key:" ",which:32}],ht=[{code:"Escape",key:"Escape",which:27}],yt=(e,t)=>{const n=u=>(u.dom.click(),a.some(!0)),o=(u,h)=>h.closest?h.focusManager.get(u).bind(m=>Je(m,h.selector)):h.focusManager.get(u),s=(u,h,m)=>o(u,m).bind(w=>m.execute(w)),r=(u,h,m)=>o(u,m).bind(w=>m.escape(w)),y=(u,h)=>{Xe(u,h.selector).each(m=>{h.focusManager.set(u,m)})},d=u=>(h,m,w)=>(w.cycles?st:ot)(h,w.selector,m,u),f=d(-1),l=d(1),c=u=>(h,m,w)=>u(h,m,w),p=(u,h,m)=>{const w=[...m.allowHorizontal?ut:[]].concat(m.allowVertical?it:[]),K=[...m.allowHorizontal?dt:[]].concat(m.allowVertical?mt:[]);return[b(x(w),c(Ye(f,l))),b(x(K),c(Ze(f,l))),b(x(lt),s),b(x(ft),s),b(x(ht),r)]},L=I([]),N={execute:n,escape:I(a.none()),allowVertical:!0,allowHorizontal:!0,cycles:!0,focusIn:!1,closest:!0,...t},F=at(N,p,L,()=>ve(N.focusIn,y));return{keydown:u=>F.handleKeydown(e,u),keyup:u=>F.handleKeyup(e,u),focus:u=>F.handleFocus(e,u)}},pt=(e,t)=>(e==null||e.addEventListener("keydown",t.keydown),e==null||e.addEventListener("keyup",t.keyup),e==null||e.addEventListener("focus",t.focus),()=>{e==null||e.removeEventListener("keydown",t.keydown),e==null||e.removeEventListener("keyup",t.keyup),e==null||e.removeEventListener("focus",t.focus)}),q=e=>{E.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=yt(v.fromDom(t.current),e);return pt(t.current,n)}else return ie},[])},k=({classes:e})=>i.jsx("span",{className:e.join(" "),style:{display:"inline-block",width:"20px",height:"20px",margin:"2px",border:"1px solid "+(e.includes("stay")?"blue":"yellow")},tabIndex:-1}),H=E.forwardRef(({testId:e},t)=>i.jsxs("div",{"data-testid":e,ref:t,className:"flow-keying-test",style:{background:"white",width:"200px",height:"200px"},children:[i.jsx(k,{classes:["stay","one"]}),i.jsx(k,{classes:["stay","two"]}),i.jsx(k,{classes:["skip","three"]}),i.jsx(k,{classes:["skip","four"]}),i.jsx(k,{classes:["stay","five"]})]}));try{H.displayName="Container",H.__docgenInfo={description:"",displayName:"Container",props:{}}}catch{}const S={render:()=>{const e=E.useRef(null);return q({containerRef:e,selector:".stay",cycles:!0}),E.useEffect(()=>{var t;e.current&&((t=e.current.querySelector(".stay"))==null||t.focus())},[]),i.jsx(H,{ref:e,testId:"container"})}};var _,A,C;S.parameters={...S.parameters,docs:{...(_=S.parameters)==null?void 0:_.docs,source:{originalSource:`{
  render: () => {
    const ref = useRef<HTMLDivElement>(null);
    useFlowKeyNavigation({
      containerRef: ref,
      selector: '.stay',
      cycles: true
    });
    useEffect(() => {
      if (ref.current) {
        ref.current.querySelector<HTMLDivElement>('.stay')?.focus();
      }
    }, []);
    return <Container ref={ref} testId='container' />;
  }
}`,...(C=(A=S.parameters)==null?void 0:A.docs)==null?void 0:C.source}}};const R={render:()=>{const e=E.useRef(null);return q({containerRef:e,selector:".stay",cycles:!1}),E.useEffect(()=>{var t;e.current&&((t=e.current.querySelector(".stay"))==null||t.focus())},[]),i.jsx(H,{ref:e,testId:"container"})}};var P,z,W;R.parameters={...R.parameters,docs:{...(P=R.parameters)==null?void 0:P.docs,source:{originalSource:`{
  render: () => {
    const ref = useRef<HTMLDivElement>(null);
    useFlowKeyNavigation({
      containerRef: ref,
      selector: '.stay',
      cycles: false
    });
    useEffect(() => {
      if (ref.current) {
        ref.current.querySelector<HTMLDivElement>('.stay')?.focus();
      }
    }, []);
    return <Container ref={ref} testId='container' />;
  }
}`,...(W=(z=R.parameters)==null?void 0:z.docs)==null?void 0:W.source}}};const T=({classes:e})=>i.jsx("span",{className:e.join(" "),style:{display:"inline-block",width:"20px",height:"20px",margin:"2px",border:"1px solid "+(e.includes("stay")?"blue":"yellow")},tabIndex:-1}),gt=e=>(e.dom.click(),a.some(!0)),O=({selector:e,execute:t=gt,escape:n=I(a.none()),allowVertical:o=!0,allowHorizontal:s=!0,cycles:r=!0,focusIn:y=!1,closest:d=!0})=>{const f=E.useRef(null);return q({containerRef:f,selector:e,allowHorizontal:s,allowVertical:o,closest:d,cycles:r,escape:n,execute:t,focusIn:y}),i.jsxs("div",{ref:f,className:"container",style:{background:"white",width:"200px",height:"200px"},children:[i.jsx(T,{classes:["stay","one"]}),i.jsx(T,{classes:["stay","two"]}),i.jsx(T,{classes:["skip","three"]}),i.jsx(T,{classes:["skip","four"]}),i.jsx(T,{classes:["stay","five"]})]})};try{O.displayName="FlowTypeDemo",O.__docgenInfo={description:"",displayName:"FlowTypeDemo",props:{execute:{defaultValue:{value:`(
  focused: SugarElement<HTMLElement>
): Optional<boolean> => {
  focused.dom.click();
  return Optional.some(true);

}`},description:"The function to execute when we press enter while the element is focused.",name:"execute",required:!1,type:{name:"((focused: SugarElement<HTMLElement>) => Optional<boolean>)"}},selector:{defaultValue:null,description:"The selector used to find the next element to focus.",name:"selector",required:!0,type:{name:"string"}},escape:{defaultValue:{value:"Fun.constant(Optional.none())"},description:"The function to execute when we press escape while the element is focused.",name:"escape",required:!1,type:{name:"((focused: SugarElement<HTMLElement>) => Optional<boolean>)"}},allowVertical:{defaultValue:{value:"true"},description:"Whether to allow vertical movement.",name:"allowVertical",required:!1,type:{name:"boolean"}},allowHorizontal:{defaultValue:{value:"true"},description:"Whether to allow horizontal movement.",name:"allowHorizontal",required:!1,type:{name:"boolean"}},cycles:{defaultValue:{value:"true"},description:"Whether to allow cycling through elements.",name:"cycles",required:!1,type:{name:"boolean"}},focusIn:{defaultValue:{value:"false"},description:"",name:"focusIn",required:!1,type:{name:"boolean"}},closest:{defaultValue:{value:"true"},description:"",name:"closest",required:!1,type:{name:"boolean"}}}}}catch{}const wt=`.stay:focus {
    background-color: #cadbee;
  }
  .skip:focus {
    background-color: red;
  }
`,kt={title:"KeyboardNavigationHooks/FlowKey",component:O,parameters:{layout:"centered",docs:{story:{autoplay:!0}}},tags:["autodocs","skip-visual-testing"],decorators:[e=>i.jsxs(i.Fragment,{children:[i.jsx("style",{children:wt}),i.jsx(e,{})]})],args:{selector:".stay"},argTypes:{containerRef:{control:!1,type:{required:!0,name:"other",value:"RefObject<HTMLElement>"},description:"RefObject<HTMLElement> - Reference to the container element that will handle keyboard navigation",table:{type:{summary:"RefObject<HTMLElement>"},defaultValue:{summary:"useRef<HTMLDivElement>(null)"}}}},play:({canvasElement:e,context:t})=>{const n=e.ownerDocument.querySelector(".container");if(n){const o=n.querySelector(t.args.selector);o==null||o.focus()}}},j={};var U,B,$;j.parameters={...j.parameters,docs:{...(U=j.parameters)==null?void 0:U.docs,source:{originalSource:"{}",...($=(B=j.parameters)==null?void 0:B.docs)==null?void 0:$.source}}};const Tt=["Basic","FlowKeyingWithCycles","FlowKeyingWithoutCycles"];export{j as Basic,S as FlowKeyingWithCycles,R as FlowKeyingWithoutCycles,Tt as __namedExportsOrder,kt as default};
