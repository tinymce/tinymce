import{r as v,j as i}from"./iframe-By4sA60t.js";import{i as B,a as I}from"./Type-DK8IqPft.js";import{n as $,a as re,c as L,b as ce}from"./Fun-DhDWU5Ah.js";class r{constructor(t,n){this.tag=t,this.value=n}static some(t){return new r(!0,t)}static none(){return r.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?r.some(t(this.value)):r.none()}bind(t){return this.tag?t(this.value):r.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:r.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return B(t)?r.some(t):r.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}r.singletonNone=new r(!1);const ae=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];if(t(s,n))return!0}return!1},le=(e,t)=>{const n=e.length,o=new Array(n);for(let s=0;s<n;s++){const c=e[s];o[s]=t(c,s)}return o},ue=(e,t)=>{const n=[];for(let o=0,s=e.length;o<s;o++){const c=e[o];t(c,o)&&n.push(c)}return n},ie=(e,t,n)=>{for(let o=0,s=e.length;o<s;o++){const c=e[o];if(t(c,o))return r.some(c);if(n(c,o))break}return r.none()},de=(e,t)=>ie(e,t,$),me=(e,t)=>{for(let n=0,o=e.length;n<o;n++){const s=e[n];if(t(s,n))return r.some(n)}return r.none()},fe=(e,t,n,o)=>{const s=e+t;return s>o?n:s<n?o:s},he=(e,t,n)=>Math.min(Math.max(e,t),n),ye=(e,t)=>e?r.some(t):r.none(),pe=(e,t)=>{const o=(t||document).createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1){const s="HTML does not have a single root node";throw console.error(s,e),new Error(s)}return T(o.childNodes[0])},ge=(e,t)=>{const o=(t||document).createElement(e);return T(o)},we=(e,t)=>{const o=(t||document).createTextNode(e);return T(o)},T=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},ve=(e,t,n)=>r.from(e.dom.elementFromPoint(t,n)).map(T),w={fromHtml:pe,fromTag:ge,fromText:we,fromDom:T,fromPoint:ve},Ee=9,G=11,X=1,xe=3,J=(e,t)=>{const n=e.dom;if(n.nodeType!==X)return!1;{const o=n;if(o.matches!==void 0)return o.matches(t);if(o.msMatchesSelector!==void 0)return o.msMatchesSelector(t);if(o.webkitMatchesSelector!==void 0)return o.webkitMatchesSelector(t);if(o.mozMatchesSelector!==void 0)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Q=e=>e.nodeType!==X&&e.nodeType!==Ee&&e.nodeType!==G||e.childElementCount===0,be=(e,t)=>{const n=t===void 0?document:t.dom;return Q(n)?[]:le(n.querySelectorAll(e),w.fromDom)},ke=(e,t)=>{const n=t===void 0?document:t.dom;return Q(n)?r.none():r.from(n.querySelector(e)).map(w.fromDom)},Te=(e,t)=>e.dom===t.dom,De=e=>e.dom.nodeName.toLowerCase(),Ne=e=>e.dom.nodeType,Y=e=>t=>Ne(t)===e,Me=Y(xe),Se=Y(G),Re=e=>Se(e)&&B(e.dom.host),Z=e=>w.fromDom(e.dom.getRootNode()),je=e=>{const t=Z(e);return Re(t)?r.some(t):r.none()},He=e=>w.fromDom(e.dom.host),Le=()=>w.fromDom(document),Fe=(e=Le())=>r.from(e.dom.activeElement).map(w.fromDom),Ie=e=>Fe(Z(e)).filter(t=>e.dom.contains(t.dom)),Ve=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},_e=e=>e.style!==void 0&&I(e.style.getPropertyValue),ee=e=>{const t=Me(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return je(w.fromDom(t)).fold(()=>n.body.contains(t),re(ee,He))},qe=(e,t)=>{const n=e.dom,s=window.getComputedStyle(n).getPropertyValue(t);return s===""&&!ee(e)?Ke(n,t):s},Ke=(e,t)=>_e(e)?e.style.getPropertyValue(t):"",Ae=e=>e.offsetWidth<=0&&e.offsetHeight<=0,Ce=e=>!Ae(e.dom),te=(e,t)=>n=>Oe(n)==="rtl"?t:e,Oe=e=>qe(e,"direction")==="rtl"?"rtl":"ltr",Pe=(e,t,n,o,s)=>e(n,o)?r.some(n):I(s)&&s(n)?r.none():t(n,o,s),ze=(e,t,n)=>{let o=e.dom;const s=I(n)?n:$;for(;o.parentNode;){o=o.parentNode;const c=w.fromDom(o);if(t(c))return r.some(c);if(s(c))break}return r.none()},We=(e,t,n)=>ze(e,o=>J(o,t),n),Ue=(e,t)=>ke(t,e),Be=(e,t,n)=>Pe((s,c)=>J(s,c),We,e,t,n),$e=(e,t)=>be(t,e),ne=e=>(t,n,o)=>{const s=e(t);return Je(s,t,n,o)},Ge=(e,t)=>{const n=te(e,t);return ne(n)},Xe=(e,t)=>{const n=te(t,e);return ne(n)},Je=(e,t,n,o)=>o.focusManager.get(t).bind(c=>e(t,c,o)).map(c=>(o.focusManager.set(t,c),!0)),Qe=(e,t)=>me(e,t).map(n=>({index:n,candidates:e})),Ye=(e,t,n)=>{const o=y=>Te(y,t),s=$e(e,n),c=ue(s,Ce);return Qe(c,o)},oe=(e,t,n,o,s)=>{const c=d=>De(d)==="button"&&Ve(d,"disabled")==="disabled",y=(d,f,l)=>s(d,f,o,0,l.length-1,l[f],a=>c(l[a])?y(d,a,l):r.from(l[a]));return Ye(e,n,t).bind(d=>{const f=d.index,l=d.candidates;return y(f,f,l)})},Ze=(e,t,n,o)=>oe(e,t,n,o,(s,c,y,d,f,l,a)=>{const p=he(c+y,d,f);return p===s?r.from(l):a(p)}),et=(e,t,n,o)=>oe(e,t,n,o,(s,c,y,d,f,l,a)=>{const p=fe(c,y,d,f);return p===s?r.none():a(p)}),tt=()=>({get:n=>Ie(n),set:(n,o)=>{o.dom.focus()}});var se=(e=>(e.OnFocusMode="onFocus",e))(se||{});const E=e=>t=>ae(e,n=>n.code===t.code||n.key===t.key||n.which===t.which),x=(e,t)=>({matches:e,classification:t}),nt=(e,t)=>de(e,o=>o.matches(t)).map(o=>o.classification),ot=(e,t,n,o)=>{const s={...e,focusManager:tt(),focusInside:se.OnFocusMode,focusIn:o},c=(l,a,p)=>{const j=p(l,a,s);return nt(j,a).bind(D=>D(l,a,s))};return{handleKeydown:(l,a)=>c(l,a,t).each(p=>{a.preventDefault(),a.stopPropagation()}),handleKeyup:(l,a)=>c(l,a,n).each(()=>{a.preventDefault(),a.stopPropagation()}),handleFocus:(l,a)=>{o(s).each(p=>{p(l,s),a.preventDefault(),a.stopPropagation()})}}},st=[{code:"Enter",key:"Enter",which:13}],rt=[{code:"ArrowLeft",key:"ArrowLeft",which:37}],ct=[{code:"ArrowUp",key:"ArrowUp",which:38}],at=[{code:"ArrowRight",key:"ArrowRight",which:39}],lt=[{code:"ArrowDown",key:"ArrowDown",which:40}],ut=[{code:"Space",key:" ",which:32}],it=[{code:"Escape",key:"Escape",which:27}],dt=(e,t)=>{const n=u=>(u.dom.click(),r.some(!0)),o=(u,h)=>h.closest?h.focusManager.get(u).bind(m=>Be(m,h.selector)):h.focusManager.get(u),s=(u,h,m)=>o(u,m).bind(g=>m.execute(g)),c=(u,h,m)=>o(u,m).bind(g=>m.escape(g)),y=(u,h)=>{Ue(u,h.selector).each(m=>{h.focusManager.set(u,m)})},d=u=>(h,m,g)=>(g.cycles?et:Ze)(h,g.selector,m,u),f=d(-1),l=d(1),a=u=>(h,m,g)=>u(h,m,g),p=(u,h,m)=>{const g=[...m.allowHorizontal?rt:[]].concat(m.allowVertical?ct:[]),_=[...m.allowHorizontal?at:[]].concat(m.allowVertical?lt:[]);return[x(E(g),a(Ge(f,l))),x(E(_),a(Xe(f,l))),x(E(st),s),x(E(ut),s),x(E(it),c)]},j=L([]),D={execute:n,escape:L(r.none()),allowVertical:!0,allowHorizontal:!0,cycles:!0,focusIn:!1,closest:!0,...t},H=ot(D,p,j,()=>ye(D.focusIn,y));return{keydown:u=>H.handleKeydown(e,u),keyup:u=>H.handleKeyup(e,u),focus:u=>H.handleFocus(e,u)}},mt=(e,t)=>(e==null||e.addEventListener("keydown",t.keydown),e==null||e.addEventListener("keyup",t.keyup),e==null||e.addEventListener("focus",t.focus),()=>{e==null||e.removeEventListener("keydown",t.keydown),e==null||e.removeEventListener("keyup",t.keyup),e==null||e.removeEventListener("focus",t.focus)}),V=e=>{v.useEffect(()=>{const{containerRef:t}=e;if(t.current){const n=dt(w.fromDom(t.current),e);return mt(t.current,n)}else return ce},[])},b=({classes:e})=>i.jsx("span",{className:e.join(" "),style:{display:"inline-block",width:"20px",height:"20px",margin:"2px",border:"1px solid "+(e.includes("stay")?"blue":"yellow")},tabIndex:-1}),R=v.forwardRef(({testId:e},t)=>i.jsxs("div",{"data-testid":e,ref:t,className:"flow-keying-test",style:{background:"white",width:"200px",height:"200px"},children:[i.jsx(b,{classes:["stay","one"]}),i.jsx(b,{classes:["stay","two"]}),i.jsx(b,{classes:["skip","three"]}),i.jsx(b,{classes:["skip","four"]}),i.jsx(b,{classes:["stay","five"]})]}));try{R.displayName="Container",R.__docgenInfo={description:"",displayName:"Container",props:{}}}catch{}const N={render:()=>{const e=v.useRef(null);return V({containerRef:e,selector:".stay",cycles:!0}),v.useEffect(()=>{var t;e.current&&((t=e.current.querySelector(".stay"))==null||t.focus())},[]),i.jsx(R,{ref:e,testId:"container"})}};var q,K,A;N.parameters={...N.parameters,docs:{...(q=N.parameters)==null?void 0:q.docs,source:{originalSource:`{
  render: () => {
    const ref = useRef<HTMLDivElement>(null);
    useFlowKeyNavigation({
      containerRef: ref,
      selector: '.stay',
      cycles: true
    });
    useEffect(() => {
      if (ref.current) {
        ref.current.querySelector<HTMLDivElement>('.stay')?.focus();
      }
    }, []);
    return <Container ref={ref} testId='container' />;
  }
}`,...(A=(K=N.parameters)==null?void 0:K.docs)==null?void 0:A.source}}};const M={render:()=>{const e=v.useRef(null);return V({containerRef:e,selector:".stay",cycles:!1}),v.useEffect(()=>{var t;e.current&&((t=e.current.querySelector(".stay"))==null||t.focus())},[]),i.jsx(R,{ref:e,testId:"container"})}};var C,O,P;M.parameters={...M.parameters,docs:{...(C=M.parameters)==null?void 0:C.docs,source:{originalSource:`{
  render: () => {
    const ref = useRef<HTMLDivElement>(null);
    useFlowKeyNavigation({
      containerRef: ref,
      selector: '.stay',
      cycles: false
    });
    useEffect(() => {
      if (ref.current) {
        ref.current.querySelector<HTMLDivElement>('.stay')?.focus();
      }
    }, []);
    return <Container ref={ref} testId='container' />;
  }
}`,...(P=(O=M.parameters)==null?void 0:O.docs)==null?void 0:P.source}}};const k=({classes:e})=>i.jsx("span",{className:e.join(" "),style:{display:"inline-block",width:"20px",height:"20px",margin:"2px",border:"1px solid "+(e.includes("stay")?"blue":"yellow")},tabIndex:-1}),ft=e=>(e.dom.click(),r.some(!0)),F=({selector:e,execute:t=ft,escape:n=L(r.none()),allowVertical:o=!0,allowHorizontal:s=!0,cycles:c=!0,focusIn:y=!1,closest:d=!0})=>{const f=v.useRef(null);return V({containerRef:f,selector:e,allowHorizontal:s,allowVertical:o,closest:d,cycles:c,escape:n,execute:t,focusIn:y}),i.jsxs("div",{ref:f,className:"container",style:{background:"white",width:"200px",height:"200px"},children:[i.jsx(k,{classes:["stay","one"]}),i.jsx(k,{classes:["stay","two"]}),i.jsx(k,{classes:["skip","three"]}),i.jsx(k,{classes:["skip","four"]}),i.jsx(k,{classes:["stay","five"]})]})};try{F.displayName="FlowTypeDemo",F.__docgenInfo={description:"",displayName:"FlowTypeDemo",props:{execute:{defaultValue:{value:`(
  focused: SugarElement<HTMLElement>
): Optional<boolean> => {
  focused.dom.click();
  return Optional.some(true);

}`},description:"The function to execute when we press enter while the element is focused.",name:"execute",required:!1,type:{name:"((focused: SugarElement<HTMLElement>) => Optional<boolean>)"}},selector:{defaultValue:null,description:"The selector used to find the next element to focus.",name:"selector",required:!0,type:{name:"string"}},escape:{defaultValue:{value:"Fun.constant(Optional.none())"},description:"The function to execute when we press escape while the element is focused.",name:"escape",required:!1,type:{name:"((focused: SugarElement<HTMLElement>) => Optional<boolean>)"}},allowVertical:{defaultValue:{value:"true"},description:"Whether to allow vertical movement.",name:"allowVertical",required:!1,type:{name:"boolean"}},allowHorizontal:{defaultValue:{value:"true"},description:"Whether to allow horizontal movement.",name:"allowHorizontal",required:!1,type:{name:"boolean"}},cycles:{defaultValue:{value:"true"},description:"Whether to allow cycling through elements.",name:"cycles",required:!1,type:{name:"boolean"}},focusIn:{defaultValue:{value:"false"},description:"",name:"focusIn",required:!1,type:{name:"boolean"}},closest:{defaultValue:{value:"true"},description:"",name:"closest",required:!1,type:{name:"boolean"}}}}}catch{}const ht=`.stay:focus {
    background-color: #cadbee;
  }
  .skip:focus {
    background-color: red;
  }
`,wt={title:"KeyboardNavigationHooks/FlowKey",component:F,parameters:{layout:"centered",docs:{story:{autoplay:!0}}},tags:["autodocs","skip-visual-testing"],decorators:[e=>i.jsxs(i.Fragment,{children:[i.jsx("style",{children:ht}),i.jsx(e,{})]})],args:{selector:".stay"},argTypes:{containerRef:{control:!1,type:{required:!0,name:"other",value:"RefObject<HTMLElement>"},description:"RefObject<HTMLElement> - Reference to the container element that will handle keyboard navigation",table:{type:{summary:"RefObject<HTMLElement>"},defaultValue:{summary:"useRef<HTMLDivElement>(null)"}}}},play:({canvasElement:e,context:t})=>{const n=e.ownerDocument.querySelector(".container");if(n){const o=n.querySelector(t.args.selector);o==null||o.focus()}}},S={};var z,W,U;S.parameters={...S.parameters,docs:{...(z=S.parameters)==null?void 0:z.docs,source:{originalSource:"{}",...(U=(W=S.parameters)==null?void 0:W.docs)==null?void 0:U.source}}};const vt=["Basic","FlowKeyingWithCycles","FlowKeyingWithoutCycles"];export{S as Basic,N as FlowKeyingWithCycles,M as FlowKeyingWithoutCycles,vt as __namedExportsOrder,wt as default};
