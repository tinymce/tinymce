import{r as n,j as h}from"./iframe-ztYUIhTB.js";import{c as k,O as w}from"./Optional-Bk48EtMP.js";const E=(t,e)=>({deltaX:e.x-t.x,deltaY:e.y-t.y}),R=(t,e,r)=>Math.min(r,Math.max(e,t)),I=(t,e,r,o)=>{const i=t.x+t.width,a=t.y+t.height;return{x:{min:Math.ceil(r.x+(e.x-t.x)),max:Math.floor(o.x-(i-e.x))},y:{min:Math.ceil(r.y+(e.y-t.y)),max:Math.floor(o.y-(a-e.y))}}},M=n.createContext(null),j=()=>{const t=n.useContext(M);if(t===null)throw new Error("Draggable compound components must be rendered within the Draggable component");return t},H=t=>`translate3d(${t.x}px, ${t.y}px, 0px)`,b=t=>"x"in t?{top:`${t.y}px`,left:`${t.x}px`}:t,P=(t,e)=>e.fold(k(t),({width:r,height:o})=>({top:`min(${t.top}, calc(100% - ${o}))`,left:`min(${t.left}, calc(100% - ${r}))`})),v=(t,e,r,o)=>r?{transform:H(t),...P(b(e),o)}:P(b(e),o),_=n.forwardRef(({children:t,style:e,initialPosition:r={top:0,left:0},declaredSize:o,...i},a)=>{const[l,d]=n.useState({x:0,y:0}),[p,g]=n.useState(r),[x,f]=n.useState(!1),m=n.useRef(null),y=v(l,p,x,w.from(o)),s=n.useMemo(()=>({setShift:d,draggableRef:m,isDragging:x,setIsDragging:f,setPosition:g}),[x]),c=n.useCallback(u=>{typeof a=="function"?a(u):a&&(a.current=u),m.current=u},[a]);return h.jsx(M.Provider,{value:s,children:h.jsx("div",{ref:c,style:{...e,...y},...i,children:t})})}),C=({children:t})=>{const e=n.useRef(null),r=n.useRef({x:0,y:0}),o=n.useRef({x:{min:0,max:0},y:{min:0,max:0}}),{setShift:i,draggableRef:a,isDragging:l,setIsDragging:d,setPosition:p}=j(),g=n.useCallback(()=>{if(d(!1),i({x:0,y:0}),a.current!==null){const s=a.current.getBoundingClientRect();p({x:Math.round(s.left),y:Math.round(s.top)})}},[d,i,a,p]),x=n.useCallback(s=>{if(a.current===null)return;d(!0),e.current=s.target,e.current.setPointerCapture(s.pointerId);const c={x:Math.round(s.clientX),y:Math.round(s.clientY)};r.current=c;const u=a.current.getBoundingClientRect();o.current=I(u,c,{x:0,y:0},{x:document.documentElement.clientWidth,y:document.documentElement.clientHeight})},[a,d]),f=n.useCallback(s=>{if(l){const c={x:R(Math.round(s.clientX),o.current.x.min,o.current.x.max),y:R(Math.round(s.clientY),o.current.y.min,o.current.y.max)},{deltaX:u,deltaY:S}=E(r.current,c);r.current=c,i(({x:D,y:$})=>({x:D+u,y:$+S}))}},[l,i]),m=n.useCallback(s=>{var c;(c=e.current)==null||c.releasePointerCapture(s.pointerId),g()},[g]),y=n.useCallback(()=>{l&&g()},[g,l]);return h.jsx("div",{onPointerDown:x,onPointerUp:m,onPointerMove:f,onLostPointerCapture:y,style:{cursor:l?"grabbing":"grab",userSelect:"none"},children:t})};try{_.displayName="Root",_.__docgenInfo={description:"",displayName:"Root",props:{popover:{defaultValue:null,description:"",name:"popover",required:!1,type:{name:'"auto" | "hint" | "manual"'}},initialPosition:{defaultValue:{value:"{ top: 0, left: 0 }"},description:"",name:"initialPosition",required:!1,type:{name:"CssPosition"}},declaredSize:{defaultValue:null,description:"",name:"declaredSize",required:!1,type:{name:"CssSize"}}}}}catch{}try{C.displayName="Handle",C.__docgenInfo={description:"",displayName:"Handle",props:{}}}catch{}export{C as H,_ as R};
