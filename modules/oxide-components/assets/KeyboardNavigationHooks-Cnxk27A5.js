var ve=Object.defineProperty;var Ee=(e,t,o)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var x=(e,t,o)=>Ee(e,typeof t!="symbol"?t+"":t,o);import{i as J,a as R,b as Se,c as Te}from"./Type-B-1gsBX3.js";import{r as O}from"./iframe-BCOZPTG7.js";import{n as Q,t as Ne,a as be,c as T,b as ke,d as De,e as $}from"./Fun-FY2GmLHR.js";const v=class v{constructor(t,o){x(this,"tag");x(this,"value");this.tag=t,this.value=o}static some(t){return new v(!0,t)}static none(){return v.singletonNone}fold(t,o){return this.tag?o(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?v.some(t(this.value)):v.none()}bind(t){return this.tag?t(this.value):v.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:v.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return J(t)?v.some(t):v.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}};x(v,"singletonNone",new v(!1));let a=v;const Me=Array.prototype.slice,xe=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const s=e[o];if(t(s,o))return!0}return!1},Ae=(e,t)=>{const o=e.length,n=new Array(o);for(let s=0;s<o;s++){const c=e[s];n[s]=t(c,s)}return n},Ke=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const s=e[o];t(s,o)}},Y=(e,t)=>{const o=[];for(let n=0,s=e.length;n<s;n++){const c=e[n];t(c,n)&&o.push(c)}return o},Re=(e,t,o)=>(Ke(e,(n,s)=>{o=t(o,n,s)}),o),Fe=(e,t,o)=>{for(let n=0,s=e.length;n<s;n++){const c=e[n];if(t(c,n))return a.some(c);if(o(c,n))break}return a.none()},k=(e,t)=>Fe(e,t,Q),Z=(e,t)=>{for(let o=0,n=e.length;o<n;o++){const s=e[o];if(t(s,o))return a.some(o)}return a.none()},Pe=(e,t)=>{for(let o=0,n=e.length;o<n;++o){const s=e[o];if(t(s,o)!==!0)return!1}return!0},L=e=>{const t=Me.call(e,0);return t.reverse(),t},Ie=(e,t,o,n)=>{const s=e+t;return s>n?o:s<o?n:s},Le=(e,t,o)=>Math.min(Math.max(e,t),o),Zt=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295,He=(e,t,o=Ne)=>e.exists(n=>o(n,t)),C=(e,t)=>e?a.some(t):a.none(),Oe=e=>t=>t.replace(e,""),$e=Oe(/^\s+|\s+$/g),Ue=(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const s="HTML does not have a single root node";throw console.error(s,e),new Error(s)}return D(n.childNodes[0])},Ve=(e,t)=>{const n=(t||document).createElement(e);return D(n)},ze=(e,t)=>{const n=(t||document).createTextNode(e);return D(n)},D=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},Be=(e,t,o)=>a.from(e.dom.elementFromPoint(t,o)).map(D),w={fromHtml:Ue,fromTag:Ve,fromText:ze,fromDom:D,fromPoint:Be},_e=9,ee=11,te=1,qe=3,oe=(e,t)=>{const o=e.dom;if(o.nodeType!==te)return!1;{const n=o;if(n.matches!==void 0)return n.matches(t);if(n.msMatchesSelector!==void 0)return n.msMatchesSelector(t);if(n.webkitMatchesSelector!==void 0)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector!==void 0)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},ne=e=>e.nodeType!==te&&e.nodeType!==_e&&e.nodeType!==ee||e.childElementCount===0,We=(e,t)=>{const o=t===void 0?document:t.dom;return ne(o)?[]:Ae(o.querySelectorAll(e),w.fromDom)},Ge=(e,t)=>{const o=t===void 0?document:t.dom;return ne(o)?a.none():a.from(o.querySelector(e)).map(w.fromDom)},U=(e,t)=>e.dom===t.dom,Xe=e=>e.dom.nodeName.toLowerCase(),je=e=>e.dom.nodeType,se=e=>t=>je(t)===e,Je=se(qe),Qe=se(ee),Ye=e=>a.from(e.dom.parentNode).map(w.fromDom),Ze=e=>Ye(e),Ce=(e,t)=>{const o=e.dom.childNodes;return a.from(o[t]).map(w.fromDom)},et=e=>Ce(e,0),tt=e=>Qe(e)&&J(e.dom.host),re=e=>w.fromDom(e.dom.getRootNode()),ot=e=>{const t=re(e);return tt(t)?a.some(t):a.none()},nt=e=>w.fromDom(e.dom.host),st=()=>w.fromDom(document),Ct=(e,t=!1)=>e.dom.focus({preventScroll:t}),rt=(e=st())=>a.from(e.dom.activeElement).map(w.fromDom),ct=e=>rt(re(e)).filter(t=>e.dom.contains(t.dom)),ce=(e,t)=>{const o=e.dom.getAttribute(t);return o===null?void 0:o},ut=(e,t)=>a.from(ce(e,t)),at=(e,t)=>{e.dom.removeAttribute(t)},F=e=>e.style!==void 0&&R(e.style.getPropertyValue),V=e=>{const t=Je(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const o=t.ownerDocument;return ot(w.fromDom(t)).fold(()=>o.body.contains(t),be(V,nt))},lt=(e,t,o)=>{if(!Se(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);F(e)&&e.style.setProperty(t,o)},it=(e,t)=>{F(e)&&e.style.removeProperty(t)},eo=(e,t,o)=>{const n=e.dom;lt(n,t,o)},H=(e,t)=>{const o=e.dom,s=window.getComputedStyle(o).getPropertyValue(t);return s===""&&!V(e)?dt(o,t):s},dt=(e,t)=>F(e)?e.style.getPropertyValue(t):"",to=(e,t)=>{const o=e.dom;it(o,t),He(ut(e,"style").map($e),"")&&at(e,"style")},mt=(e,t)=>{const o=(u,i)=>{if(!Te(i)&&!i.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+i);const r=u.dom;F(r)&&(r.style[e]=i+"px")},n=u=>{const i=t(u);if(i<=0||i===null){const r=H(u,e);return parseFloat(r)||0}return i},s=n,c=(u,i)=>Re(i,(r,l)=>{const p=H(u,l),S=p===void 0?0:parseInt(p,10);return isNaN(S)?r:r+S},0);return{set:o,get:n,getOuter:s,aggregate:c,max:(u,i,r)=>{const l=c(u,r);return i>l?i-l:0}}},ft=mt("height",e=>{const t=e.dom;return V(e)?t.getBoundingClientRect().height:t.offsetHeight}),ht=e=>ft.get(e),yt=e=>e.offsetWidth<=0&&e.offsetHeight<=0,pt=e=>!yt(e.dom),ue=(e,t)=>o=>gt(o)==="rtl"?t:e,gt=e=>H(e,"direction")==="rtl"?"rtl":"ltr",wt=(e,t,o,n,s)=>e(o,n)?a.some(o):R(s)&&s(o)?a.none():t(o,n,s),vt=(e,t,o)=>{let n=e.dom;const s=R(o)?o:Q;for(;n.parentNode;){n=n.parentNode;const c=w.fromDom(n);if(t(c))return a.some(c);if(s(c))break}return a.none()},Et=(e,t,o)=>vt(e,n=>oe(n,t),o),St=(e,t)=>Ge(t,e),ae=(e,t,o)=>wt((s,c)=>oe(s,c),Et,e,t,o),z=(e,t)=>We(t,e),le=e=>(t,o,n)=>{const s=e(t);return bt(s,t,o,n)},Tt=(e,t)=>{const o=ue(e,t);return le(o)},Nt=(e,t)=>{const o=ue(t,e);return le(o)},bt=(e,t,o,n)=>n.focusManager.get(t).bind(c=>e(t,c,n)).map(c=>(n.focusManager.set(t,c),!0)),kt=(e,t)=>Z(e,t).map(o=>({index:o,candidates:e})),Dt=(e,t,o)=>{const n=y=>U(y,t),s=z(e,o),c=Y(s,pt);return kt(c,n)},ie=(e,t,o,n,s)=>{const c=u=>Xe(u)==="button"&&ce(u,"disabled")==="disabled",y=(u,i,r)=>s(u,i,n,0,r.length-1,r[i],l=>c(r[l])?y(u,l,r):a.from(r[l]));return Dt(e,o,t).bind(u=>{const i=u.index,r=u.candidates;return y(i,i,r)})},Mt=(e,t,o,n)=>ie(e,t,o,n,(s,c,y,u,i,r,l)=>{const p=Le(c+y,u,i);return p===s?a.from(r):l(p)}),xt=(e,t,o,n)=>ie(e,t,o,n,(s,c,y,u,i,r,l)=>{const p=Ie(c,y,u,i);return p===s?a.none():l(p)}),At=()=>({get:o=>ct(o),set:(o,n)=>{n.dom.focus()}});var de=(e=>(e.OnFocusMode="onFocus",e))(de||{});const m=e=>t=>xe(e,o=>o.code===t.code||o.key===t.key||o.which===t.which),N=e=>t=>Pe(e,o=>o(t)),A=e=>e.shiftKey===!0,X=e=>!A(e),f=(e,t)=>({matches:e,classification:t}),Kt=(e,t)=>k(e,n=>n.matches(t)).map(n=>n.classification),B=(e,t,o,n)=>{const s={...e,focusManager:At(),focusInside:de.OnFocusMode,focusIn:n},c=(r,l,p)=>{const S=p(r,l,s);return Kt(S,l).bind(M=>M(r,l,s))};return{handleKeydown:(r,l)=>c(r,l,t).each(p=>{l.preventDefault(),l.stopPropagation()}),handleKeyup:(r,l)=>c(r,l,o).each(()=>{l.preventDefault(),l.stopPropagation()}),handleFocus:(r,l)=>{n(s).each(p=>{p(r,s),l.preventDefault(),l.stopPropagation()})}}},b=[{code:"Tab",key:"Tab",which:9}],K=[{code:"Enter",key:"Enter",which:13}],me=[{code:"ArrowLeft",key:"ArrowLeft",which:37}],fe=[{code:"ArrowUp",key:"ArrowUp",which:38}],he=[{code:"ArrowRight",key:"ArrowRight",which:39}],ye=[{code:"ArrowDown",key:"ArrowDown",which:40}],_=[{code:"Space",key:" ",which:32}],q=[{code:"Escape",key:"Escape",which:27}],Rt=(e,t)=>{const o=d=>(d.dom.click(),a.some(!0)),n=(d,g)=>g.closest?g.focusManager.get(d).bind(h=>ae(h,g.selector)):g.focusManager.get(d),s=(d,g,h)=>n(d,h).bind(E=>h.execute(E)),c=(d,g,h)=>n(d,h).bind(E=>h.escape(E)),y=(d,g)=>{St(d,g.selector).each(h=>{g.focusManager.set(d,h)})},u=d=>(g,h,E)=>(E.cycles?xt:Mt)(g,E.selector,h,d),i=u(-1),r=u(1),l=d=>(g,h,E)=>d(g,h,E),p=(d,g,h)=>{const E=[...h.allowHorizontal?me:[]].concat(h.allowVertical?fe:[]),G=[...h.allowHorizontal?he:[]].concat(h.allowVertical?ye:[]);return[f(m(E),l(Tt(i,r))),f(m(G),l(Nt(i,r))),f(m(K),s),f(m(_),s),f(m(q),c)]},S=T([]),M={execute:o,escape:T(a.none()),allowVertical:!0,allowHorizontal:!0,cycles:!0,focusIn:!1,closest:!0,...t},I=B(M,p,S,()=>C(M.focusIn,y));return{keydown:d=>I.handleKeydown(e,d),keyup:d=>I.handleKeyup(e,d),focus:d=>I.handleFocus(e,d)}},Ft=(e,t)=>{const o=(u,i,r)=>[f(N([A,m(K)]),r.onShiftEnter),f(N([X,m(K)]),r.onEnter),f(N([A,m(b)]),r.onShiftTab),f(N([X,m(b)]),r.onTab),f(m(fe),r.onUp),f(m(ye),r.onDown),f(m(me),r.onLeft),f(m(he),r.onRight),f(m(_),r.onSpace)],n=(u,i,r)=>[f(m(q),r.onEscape)],s=u=>()=>R(u)?(u(),a.some(!0)):a.none(),c={onSpace:s(t.onSpace),onEnter:s(t.onEnter),onShiftEnter:s(t.onShiftEnter),onTab:s(t.onTab),onShiftTab:s(t.onShiftTab),onLeft:s(t.onLeft),onRight:s(t.onRight),onUp:s(t.onUp),onDown:s(t.onDown),onEscape:s(t.onEscape)},y=B(c,o,n,()=>a.none());return{keydown:u=>y.handleKeydown(e,u),keyup:u=>y.handleKeyup(e,u),focus:u=>y.handleFocus(e,u)}},Pt=(e,t,o)=>{const n=L(e.slice(0,t)),s=L(e.slice(t+1));return k(n.concat(s),o)},It=(e,t,o)=>{const n=L(e.slice(0,t));return k(n,o)},Lt=(e,t,o)=>{const n=e.slice(0,t),s=e.slice(t+1);return k(s.concat(n),o)},Ht=(e,t,o)=>{const n=e.slice(t+1);return k(n,o)},Ot=e=>ht(e)>0,$t=(e,t)=>{const o=z(e,t.selector),n=Y(o,s=>Ot(s));return a.from(n[t.firstTabstop])},P=(e,t)=>t.closest?t.focusManager.get(e).bind(o=>ae(o,t.selector)):t.focusManager.get(e),Ut=(e,t)=>e.useTabstopAt(t),Vt=e=>Ze(e).bind(et).exists(t=>U(t,e)),zt=(e,t)=>{$t(e,t).each(o=>t.focusManager.set(e,o))},Bt=(e,t,o,n,s)=>s(t,o,c=>Ut(n,c)).fold(()=>n.cyclic?a.some(!0):a.none(),c=>(n.focusManager.set(e,c),a.some(!0))),pe=(e,t,o,n)=>{const s=z(e,o.selector);return P(e,o).bind(c=>Z(s,De(U,c)).bind(u=>Bt(e,s,u,o,n)))},ge=(e,t,o)=>{const n=o.cyclic?Pt:It;return pe(e,t,o,n)},we=(e,t,o)=>{const n=o.cyclic?Lt:Ht;return pe(e,t,o,n)},_t=(e,t,o)=>P(e,o).filter(n=>!o.useTabstopAt(n)).bind(n=>(Vt(n)?ge:we)(e,t,o)),j=(e,t,o)=>P(e,o).bind(n=>o.execute(n)),qt=(e,t,o)=>P(e,o).bind(n=>o.escape(n)),Wt=T([f(N([A,m(b)]),ge),f(m(b),we),f(m(K),j),f(m(_),j),f(m(q),qt)]),Gt=T([f(m(b),_t)]),Xt=(e,t)=>{const o={execute:T(a.none()),escape:T(a.none()),firstTabstop:0,useTabstopAt:ke,cyclic:!0,focusIn:!1,closest:!0,...t},n=B(o,Wt,Gt,()=>C(o.focusIn,zt));return{keydown:s=>n.handleKeydown(e,s),keyup:s=>n.handleKeyup(e,s),focus:s=>n.handleFocus(e,s)}},W=(e,t)=>(e==null||e.addEventListener("keydown",t.keydown),e==null||e.addEventListener("keyup",t.keyup),e==null||e.addEventListener("focus",t.focus),()=>{e==null||e.removeEventListener("keydown",t.keydown),e==null||e.removeEventListener("keyup",t.keyup),e==null||e.removeEventListener("focus",t.focus)}),oo=e=>{O.useEffect(()=>{const{containerRef:t}=e;if(t.current){const o=Xt(w.fromDom(t.current),e);return W(t.current,o)}else return $},[])},no=e=>{O.useEffect(()=>{const{containerRef:t}=e;if(t.current){const o=Rt(w.fromDom(t.current),e);return W(t.current,o)}else return $},[])},so=e=>{O.useEffect(()=>{const{containerRef:t}=e;if(t.current){const o=Ft(w.fromDom(t.current),e);return W(t.current,o)}else return $},[e])};export{a as O,w as S,oo as a,to as b,no as c,St as d,Ke as e,Ct as f,z as g,Ye as p,Zt as r,eo as s,so as u};
