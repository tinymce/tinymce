import{r as a,j as P}from"./iframe-BdJ3TlxI.js";import{e as _,O as I}from"./Optional-DSwtTfFR.js";import{c as L}from"./Fun--VEwoXIw.js";const v=t=>t==="top-left",w=t=>t==="top-right",E=t=>t==="bottom-left",V=t=>v(t)||E(t),j=t=>v(t)||w(t),q=(t,e)=>({deltaX:e.x-t.x,deltaY:e.y-t.y}),M=(t,e,o)=>Math.min(o,Math.max(e,t)),B=(t,e,o)=>{const r=t.x+t.width,i=t.y+t.height;return{x:Math.round(V(o)?t.x:e.width-r),y:Math.round(j(o)?t.y:e.height-i)}},N=(t,e,o,r)=>{const{upperLeftCorner:i,bottomRightCorner:n}=o,s=t.x+t.width,x=t.y+t.height;return{x:{min:Math.ceil(i.x+(e.x-t.x))-r.horizontal,max:Math.floor(n.x-(s-e.x))+r.horizontal},y:{min:Math.ceil(i.y+(e.y-t.y))-r.vertical,max:Math.floor(n.y-(x-e.y))+r.vertical}}},H=a.createContext(null),T=()=>{const t=a.useContext(H);if(t===null)throw new Error("Draggable compound components must be rendered within the Draggable component");return t},X=t=>`translate3d(${t.x}px, ${t.y}px, 0px)`,$=t=>({x:_(t.x)?`${t.x}px`:t.x,y:_(t.y)?`${t.y}px`:t.y}),z=(t,e,o,r)=>{const{x:i,y:n}=r.fold(L(t),({width:s,height:x})=>{let g=t.x,f=t.y;if(e.horizontal<1){let l;if(e.horizontal>0){const u=(1-e.horizontal).toFixed(2);l=`${s} * ${u}`}else l=`${s}`;g=`min( ${t.x}, calc( 100% - ${l} ) )`}if(e.vertical<1){let l;if(e.vertical>0){const u=(1-e.vertical).toFixed(2);l=`${x} * ${u}`}else l=`${x}`;f=`min( ${t.y}, calc( 100% - ${l} ) )`}return{x:g,y:f}});return v(o)?{top:n,left:i}:w(o)?{top:n,right:i}:E(o)?{bottom:n,left:i}:{bottom:n,right:i}},Y=(t,e,o,r,i,n)=>i?{transform:X(t),...z($(e),r,o,n)}:z($(e),r,o,n),S=a.forwardRef(({children:t,style:e,origin:o="top-left",initialPosition:r={x:0,y:0},declaredSize:i,...n},s)=>{const[x,g]=a.useState({x:0,y:0}),[f,l]=a.useState(r),[u,b]=a.useState(!1),y=a.useRef(null),p=a.useMemo(()=>{var m,h;return{horizontal:((m=n.allowedOverflow)==null?void 0:m.horizontal)??0,vertical:((h=n.allowedOverflow)==null?void 0:h.vertical)??0}},[n.allowedOverflow]),R=Y(x,f,o,p,u,I.from(i)),c=a.useMemo(()=>({setShift:g,draggableRef:y,isDragging:u,setIsDragging:b,setPosition:l,allowedOverflow:p,origin:o}),[u,p,o]),d=a.useCallback(m=>{typeof s=="function"?s(m):s&&(s.current=m),y.current=m},[s]);return P.jsx(H.Provider,{value:c,children:P.jsx("div",{ref:d,style:{...e,...R},...n,children:t})})}),D=({children:t})=>{const e=a.useRef(null),o=a.useRef({x:0,y:0}),r=a.useRef({x:{min:0,max:0},y:{min:0,max:0}}),{setShift:i,draggableRef:n,isDragging:s,setIsDragging:x,setPosition:g,allowedOverflow:f,origin:l}=T(),u=a.useCallback(()=>{if(x(!1),i({x:0,y:0}),n.current!==null){const c=n.current.getBoundingClientRect(),d={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};g(B(c,d,l))}},[x,i,n,g,l]),b=a.useCallback(c=>{if(n.current===null)return;x(!0),e.current=c.target,e.current.setPointerCapture(c.pointerId);const d={x:Math.round(c.clientX),y:Math.round(c.clientY)};o.current=d;const m=n.current.getBoundingClientRect(),h={horizontal:Math.round(m.width*f.horizontal),vertical:Math.round(m.height*f.vertical)},C={upperLeftCorner:{x:0,y:0},bottomRightCorner:{x:document.documentElement.clientWidth,y:document.documentElement.clientHeight}};r.current=N(m,d,C,h)},[n,x,f]),y=a.useCallback(c=>{if(s){const d={x:M(Math.round(c.clientX),r.current.x.min,r.current.x.max),y:M(Math.round(c.clientY),r.current.y.min,r.current.y.max)},{deltaX:m,deltaY:h}=q(o.current,d);o.current=d,i(({x:C,y:k})=>({x:C+m,y:k+h}))}},[s,i]),p=a.useCallback(c=>{var d;(d=e.current)==null||d.releasePointerCapture(c.pointerId),u()},[u]),R=a.useCallback(()=>{s&&u()},[u,s]);return P.jsx("div",{onPointerDown:b,onPointerUp:p,onPointerMove:y,onLostPointerCapture:R,style:{cursor:s?"grabbing":"grab",userSelect:"none"},children:t})};try{S.displayName="Root",S.__docgenInfo={description:"",displayName:"Root",props:{popover:{defaultValue:null,description:"",name:"popover",required:!1,type:{name:'"auto" | "hint" | "manual"'}},origin:{defaultValue:{value:"top-left"},description:"",name:"origin",required:!1,type:{name:"Origin"}},initialPosition:{defaultValue:{value:"{ x: 0, y: 0 }"},description:"",name:"initialPosition",required:!1,type:{name:"CssPosition"}},declaredSize:{defaultValue:null,description:"",name:"declaredSize",required:!1,type:{name:"CssSize"}},allowedOverflow:{defaultValue:null,description:"",name:"allowedOverflow",required:!1,type:{name:"Partial<AllowedOverflow>"}}}}}catch{}try{D.displayName="Handle",D.__docgenInfo={description:"",displayName:"Handle",props:{}}}catch{}export{D as H,S as R};
