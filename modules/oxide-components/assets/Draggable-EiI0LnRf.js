import{r as n,j as C}from"./iframe-DrWVuu1b.js";import{O as D}from"./Optional-CHj922Ci.js";import{c as $}from"./Fun--VEwoXIw.js";const k=(t,e)=>({deltaX:e.x-t.x,deltaY:e.y-t.y}),P=(t,e,l)=>Math.min(l,Math.max(e,t)),E=(t,e,l,r)=>{const{upperLeftCorner:o,bottomRightCorner:a}=l,u=t.x+t.width,d=t.y+t.height;return{x:{min:Math.ceil(o.x+(e.x-t.x))-r.horizontal,max:Math.floor(a.x-(u-e.x))+r.horizontal},y:{min:Math.ceil(o.y+(e.y-t.y))-r.vertical,max:Math.floor(a.y-(d-e.y))+r.vertical}}},S=n.createContext(null),I=()=>{const t=n.useContext(S);if(t===null)throw new Error("Draggable compound components must be rendered within the Draggable component");return t},O=t=>`translate3d(${t.x}px, ${t.y}px, 0px)`,_=t=>"x"in t?{top:`${t.y}px`,left:`${t.x}px`}:t,v=(t,e,l)=>l.fold($(t),({width:r,height:o})=>({top:`min(${t.top}, calc(100% - (${o} * ${1-e.vertical}))`,left:`min(${t.left}, calc(100% - (${r} * ${1-e.horizontal}))`})),j=(t,e,l,r,o)=>r?{transform:O(t),...v(_(e),l,o)}:v(_(e),l,o),w=n.forwardRef(({children:t,style:e,initialPosition:l={top:0,left:0},declaredSize:r,...o},a)=>{const[u,d]=n.useState({x:0,y:0}),[x,m]=n.useState(l),[f,y]=n.useState(!1),h=n.useRef(null),p=n.useMemo(()=>{var c,g;return{horizontal:((c=o.allowedOverflow)==null?void 0:c.horizontal)??0,vertical:((g=o.allowedOverflow)==null?void 0:g.vertical)??0}},[o.allowedOverflow]),R=j(u,x,p,f,D.from(r)),i=n.useMemo(()=>({setShift:d,draggableRef:h,isDragging:f,setIsDragging:y,setPosition:m,allowedOverflow:p}),[f,p]),s=n.useCallback(c=>{typeof a=="function"?a(c):a&&(a.current=c),h.current=c},[a]);return C.jsx(S.Provider,{value:i,children:C.jsx("div",{ref:s,style:{...e,...R},...o,children:t})})}),M=({children:t})=>{const e=n.useRef(null),l=n.useRef({x:0,y:0}),r=n.useRef({x:{min:0,max:0},y:{min:0,max:0}}),{setShift:o,draggableRef:a,isDragging:u,setIsDragging:d,setPosition:x,allowedOverflow:m}=I(),f=n.useCallback(()=>{if(d(!1),o({x:0,y:0}),a.current!==null){const i=a.current.getBoundingClientRect();x({x:Math.round(i.left),y:Math.round(i.top)})}},[d,o,a,x]),y=n.useCallback(i=>{if(a.current===null)return;d(!0),e.current=i.target,e.current.setPointerCapture(i.pointerId);const s={x:Math.round(i.clientX),y:Math.round(i.clientY)};l.current=s;const c=a.current.getBoundingClientRect(),g={horizontal:Math.round(c.width*m.horizontal),vertical:Math.round(c.height*m.vertical)},b={upperLeftCorner:{x:0,y:0},bottomRightCorner:{x:document.documentElement.clientWidth,y:document.documentElement.clientHeight}};r.current=E(c,s,b,g)},[a,d,m]),h=n.useCallback(i=>{if(u){const s={x:P(Math.round(i.clientX),r.current.x.min,r.current.x.max),y:P(Math.round(i.clientY),r.current.y.min,r.current.y.max)},{deltaX:c,deltaY:g}=k(l.current,s);l.current=s,o(({x:b,y:z})=>({x:b+c,y:z+g}))}},[u,o]),p=n.useCallback(i=>{var s;(s=e.current)==null||s.releasePointerCapture(i.pointerId),f()},[f]),R=n.useCallback(()=>{u&&f()},[f,u]);return C.jsx("div",{onPointerDown:y,onPointerUp:p,onPointerMove:h,onLostPointerCapture:R,style:{cursor:u?"grabbing":"grab",userSelect:"none"},children:t})};try{w.displayName="Root",w.__docgenInfo={description:"",displayName:"Root",props:{popover:{defaultValue:null,description:"",name:"popover",required:!1,type:{name:'"auto" | "hint" | "manual"'}},initialPosition:{defaultValue:{value:"{ top: 0, left: 0 }"},description:"",name:"initialPosition",required:!1,type:{name:"CssPosition"}},declaredSize:{defaultValue:null,description:"",name:"declaredSize",required:!1,type:{name:"CssSize"}},allowedOverflow:{defaultValue:null,description:"",name:"allowedOverflow",required:!1,type:{name:"Partial<AllowedOverflow>"}}}}}catch{}try{M.displayName="Handle",M.__docgenInfo={description:"",displayName:"Handle",props:{}}}catch{}export{M as H,w as R};
