import{r as l,j as N}from"./iframe-BXWNty1W.js";import{d as L,e as T,i as v,b as S}from"./Optional-CuHnBc-7.js";import{e as I}from"./Obj-BYXNADYo.js";import{b as $}from"./Bem-BJplfvtK.js";const V=(e,o)=>{let t=null;const s=()=>{L(t)||(clearTimeout(t),t=null)};return{cancel:s,throttle:(...p)=>{s(),t=setTimeout(()=>{t=null,e.apply(null,p)},o)}}},k=l.createContext(null),H=()=>{const e=l.useContext(k);if(e===null)throw new Error("Dropdown compound components must be rendered within the Dropdown component");return e},W=(e,o,t)=>e==="top"?o.top-t.top:t.bottom-o.bottom,q=(e,o,t)=>e==="left"?o.left-t.left:t.right-o.right,O=({anchorRect:e,anchoredContainerRect:o,side:t,align:s,gap:i,boundaryRect:p=document.documentElement.getBoundingClientRect()})=>{if(t==="top"||t==="bottom"){const n=W(t,e,p),d=t==="top"?e.top-o.height-i:e.bottom+i;let r=e.left;return s==="center"&&(r=e.left+e.width/2-o.width/2),s==="end"&&(r=e.right-o.width),{maxHeight:`${n}px`,top:`${d}px`,left:`${r}px`,minWidth:`${e.width}px`}}if(t==="left"||t==="right"){const n=q(t,e,p),d=t==="left"?e.left-o.width-i:e.right+i;let r=e.top;return s==="center"&&(r=e.top-o.width/2+e.width/2),s==="end"&&(r=e.bottom-o.height),{maxWidth:`${n}px`,top:`${r}px`,left:`${d}px`,minWidth:`${e.width}px`}}return{}},D=(e,o)=>e.current?.contains(o)??!1,b=l.forwardRef(({children:e,onOpenChange:o,...t},s)=>{const{triggerRef:i,side:p,align:n,gap:d,contentRef:r,triggerEvents:c,debouncedHideHoverablePopover:f,isOpen:a,setIsOpen:x}=H(),[M,y]=l.useState({opacity:"0"}),E=l.useCallback(u=>{x(u.newState==="open")},[x]),w=l.useCallback(()=>{if(v(i.current)&&v(r.current)){const u=document.documentElement.getBoundingClientRect(),m=i.current.getBoundingClientRect(),g=r.current.getBoundingClientRect(),h={opacity:"1",...O({anchorRect:m,anchoredContainerRect:g,side:p,align:n,gap:d,boundaryRect:u})};y(_=>I(h,_)?_:h)}},[r,i,n,p,d]);return l.useEffect(()=>{const u=r.current;if(S(u))return;const m=g=>{E(g),g.newState==="closed"?((r.current?.contains(document.activeElement)||document.activeElement===document.body)&&i.current?.focus(),o?.(!1)):o?.(!0)};return u.addEventListener("toggle",m),()=>{u.removeEventListener("toggle",m)}},[r,i,E,o]),l.useEffect(()=>{a?w():y({opacity:"0"})},[a,w,e]),l.useEffect(()=>{const u=()=>{r.current?.hidePopover()};return window.addEventListener("scroll",u,!0),window.addEventListener("resize",u),()=>{window.removeEventListener("scroll",u,!0),window.removeEventListener("resize",u)}},[w,i,r]),N.jsx("div",{popover:"auto",className:$("tox-dropdown-content"),ref:u=>{r.current=u,T(s)?s(u):v(s)&&(s.current=u)},style:{...M},...c.includes("hover")&&{onMouseLeave:f.throttle,onMouseEnter:()=>f.cancel()},...t,children:a&&e})}),C=({children:e})=>{const{triggerRef:o,contentRef:t,triggerEvents:s,debouncedHideHoverablePopover:i,isOpen:p}=H();let n=l.Children.toArray(e)[0];if(!l.isValidElement(n))return null;n=n;const d={onMouseEnter:c=>{n.props.onMouseEnter?.(c),i.cancel(),t.current?.showPopover()},onMouseLeave:c=>{n.props.onMouseLeave?.(c),i.throttle(c)}},r={onClick:c=>{n.props.onClick?.(c),p?t.current?.hidePopover():t.current?.showPopover()}};return l.cloneElement(n,{ref:c=>{o.current=c,T(n.props.ref)?n.props.ref(c):v(n.props.ref)&&(n.props.ref.current=c)},...s.includes("click")&&r,...s.includes("hover")&&d})},P=({children:e,side:o="top",align:t="start",gap:s=8,triggerEvents:i=["click"]})=>{const p=l.useRef(),n=l.useRef(),[d,r]=l.useState(!1),c=l.useMemo(()=>V(a=>{(!(a.relatedTarget instanceof Node)||!D(n,a.relatedTarget))&&n.current?.hidePopover()},300),[]),f=l.useMemo(()=>({triggerRef:p,contentRef:n,side:o,align:t,gap:s,triggerEvents:i,debouncedHideHoverablePopover:c,isOpen:d,setIsOpen:r}),[p,n,o,t,s,i,c,d]);return N.jsx(k.Provider,{value:f,children:e})};try{P.displayName="Root",P.__docgenInfo={description:"",displayName:"Root",props:{side:{defaultValue:{value:"top"},description:"",name:"side",required:!1,type:{name:'"left" | "right" | "top" | "bottom"'}},align:{defaultValue:{value:"start"},description:"",name:"align",required:!1,type:{name:'"start" | "center" | "end"'}},gap:{defaultValue:{value:"8"},description:"",name:"gap",required:!1,type:{name:"number"}},triggerEvents:{defaultValue:{value:"[ 'click' ]"},description:"",name:"triggerEvents",required:!1,type:{name:'("click" | "hover")[]'}}}}}catch{}try{b.displayName="Content",b.__docgenInfo={description:"",displayName:"Content",props:{onOpenChange:{defaultValue:null,description:"",name:"onOpenChange",required:!1,type:{name:"((isOpen: boolean) => void)"}}}}}catch{}try{C.displayName="Trigger",C.__docgenInfo={description:"",displayName:"Trigger",props:{}}}catch{}export{b as C,P as R,C as T};
