import{r as l,j as C}from"./iframe-O7hL-UMi.js";import{c as L,d as k,a as x,b as S}from"./Optional-DSwtTfFR.js";import{e as V}from"./Obj-CJaV3SWn.js";import{b as q}from"./Bem--smchjkv.js";const I=(e,o)=>{let t=null;const s=()=>{L(t)||(clearTimeout(t),t=null)};return{cancel:s,throttle:(...d)=>{s(),t=setTimeout(()=>{t=null,e.apply(null,d)},o)}}},H=l.createContext(null),M=()=>{const e=l.useContext(H);if(e===null)throw new Error("Dropdown compound components must be rendered within the Dropdown component");return e},$=(e,o,t)=>e==="top"?o.top-t.top:t.bottom-o.bottom,D=(e,o,t)=>e==="left"?o.left-t.left:t.right-o.right,O=({anchorRect:e,anchoredContainerRect:o,side:t,align:s,gap:i,boundaryRect:d=document.documentElement.getBoundingClientRect()})=>{if(t==="top"||t==="bottom"){const r=$(t,e,d),f=t==="top"?e.top-o.height-i:e.bottom+i;let n=e.left;return s==="center"&&(n=e.left+e.width/2-o.width/2),s==="end"&&(n=e.right-o.width),{maxHeight:`${r}px`,top:`${f}px`,left:`${n}px`}}if(t==="left"||t==="right"){const r=D(t,e,d),f=t==="left"?e.left-o.width-i:e.right+i;let n=e.top;return s==="center"&&(n=e.top-o.width/2+e.width/2),s==="end"&&(n=e.bottom-o.height),{maxWidth:`${r}px`,top:`${n}px`,left:`${f}px`}}return{}},j=(e,o)=>{var t;return((t=e.current)==null?void 0:t.contains(o))??!1},P=l.forwardRef(({children:e,onClose:o,...t},s)=>{const{triggerRef:i,side:d,align:r,gap:f,contentRef:n,triggerEvents:c,debouncedHideHoverablePopover:a,isOpen:p,setIsOpen:g}=M(),[w,_]=l.useState({opacity:"0"}),E=l.useCallback(u=>{g(u.newState==="open")},[g]),y=l.useCallback(()=>{if(x(i.current)&&x(n.current)){const u=document.documentElement.getBoundingClientRect(),m=i.current.getBoundingClientRect(),h=n.current.getBoundingClientRect(),v={opacity:"1",...O({anchorRect:m,anchoredContainerRect:h,side:d,align:r,gap:f,boundaryRect:u})};_(b=>V(v,b)?b:v)}},[n,i,r,d,f]);return l.useEffect(()=>{const u=n.current;if(S(u))return;const m=h=>{var v;E(h),h.newState==="closed"&&((v=i.current)==null||v.focus(),o==null||o())};return u.addEventListener("toggle",m),()=>{u.removeEventListener("toggle",m)}},[n,i,E,o]),l.useEffect(()=>{p?y():_({opacity:"0"})},[p,y,e]),l.useEffect(()=>{const u=()=>{var m;(m=n.current)==null||m.hidePopover()};return window.addEventListener("scroll",u,!0),window.addEventListener("resize",u),()=>{window.removeEventListener("scroll",u,!0),window.removeEventListener("resize",u)}},[y,i,n]),C.jsx("div",{popover:"auto",className:q("tox-dropdown-content"),ref:u=>{n.current=u,k(s)?s(u):x(s)&&(s.current=u)},style:{...w},...c.includes("hover")&&{onMouseLeave:a.throttle,onMouseEnter:()=>a.cancel()},...t,children:p&&e})}),N=({children:e})=>{const{triggerRef:o,contentRef:t,triggerEvents:s,debouncedHideHoverablePopover:i,isOpen:d}=M();let r=l.Children.toArray(e)[0];if(!l.isValidElement(r))return null;r=r;const f={onMouseEnter:c=>{var a,p,g;(p=(a=r.props).onMouseEnter)==null||p.call(a,c),i.cancel(),(g=t.current)==null||g.showPopover()},onMouseLeave:c=>{var a,p;(p=(a=r.props).onMouseLeave)==null||p.call(a,c),i.throttle(c)}},n={onClick:c=>{var a,p,g,w;(p=(a=r.props).onClick)==null||p.call(a,c),d?(g=t.current)==null||g.hidePopover():(w=t.current)==null||w.showPopover()}};return l.cloneElement(r,{ref:c=>{o.current=c,k(r.props.ref)?r.props.ref(c):x(r.props.ref)&&(r.props.ref.current=c)},...s.includes("click")&&n,...s.includes("hover")&&f})},T=({children:e,side:o="top",align:t="start",gap:s=8,triggerEvents:i=["click"]})=>{const d=l.useRef(),r=l.useRef(),[f,n]=l.useState(!1),c=l.useMemo(()=>I(p=>{var g;(!(p.relatedTarget instanceof Node)||!j(r,p.relatedTarget))&&((g=r.current)==null||g.hidePopover())},300),[]),a=l.useMemo(()=>({triggerRef:d,contentRef:r,side:o,align:t,gap:s,triggerEvents:i,debouncedHideHoverablePopover:c,isOpen:f,setIsOpen:n}),[d,r,o,t,s,i,c,f]);return C.jsx(H.Provider,{value:a,children:e})};try{T.displayName="Root",T.__docgenInfo={description:"",displayName:"Root",props:{side:{defaultValue:{value:"top"},description:"",name:"side",required:!1,type:{name:'"top" | "bottom" | "left" | "right"'}},align:{defaultValue:{value:"start"},description:"",name:"align",required:!1,type:{name:'"start" | "end" | "center"'}},gap:{defaultValue:{value:"8"},description:"",name:"gap",required:!1,type:{name:"number"}},triggerEvents:{defaultValue:{value:"[ 'click' ]"},description:"",name:"triggerEvents",required:!1,type:{name:'("click" | "hover")[]'}}}}}catch{}try{P.displayName="Content",P.__docgenInfo={description:"",displayName:"Content",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}try{N.displayName="Trigger",N.__docgenInfo={description:"",displayName:"Trigger",props:{}}}catch{}export{P as C,T as R,N as T};
